<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="2.1 Información previa | Modelos Bayesianos con R y STAN" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Este es el repositorio del libro Modelos Bayesianos con R y STAN." />
<meta name="github-repo" content="psirusteam/bookdownBayesiano" />

<meta name="author" content="Andrés Gutiérrez - Hanwen Zhang" />

<meta name="date" content="2021-05-30" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Este es el repositorio del libro Modelos Bayesianos con R y STAN.">

<title>2.1 Información previa | Modelos Bayesianos con R y STAN</title>

<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<link href="libs/tufte-css-2015.12.29/tufte-fonts.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-background.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte-italics.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />





</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#prefacio">Prefacio</a></li>
<li><a href="1-tópicos-básicos.html#tópicos-básicos"><span class="toc-section-number">1</span> Tópicos básicos</a>
<ul>
<li><a href="1-1-teoría-de-la-decisión.html#teoría-de-la-decisión"><span class="toc-section-number">1.1</span> Teoría de la decisión</a></li>
<li><a href="1-2-algunos-resultados-de-probabilidad.html#algunos-resultados-de-probabilidad"><span class="toc-section-number">1.2</span> Algunos resultados de probabilidad</a></li>
<li><a href="1-3-teorema-de-bayes.html#teorema-de-bayes"><span class="toc-section-number">1.3</span> Teorema de Bayes</a></li>
</ul></li>
<li><a href="2-inferencia-bayesiana.html#inferencia-bayesiana"><span class="toc-section-number">2</span> Inferencia bayesiana</a>
<ul>
<li><a href="2-1-información-previa.html#información-previa"><span class="toc-section-number">2.1</span> Información previa</a>
<ul>
<li><a href="2-1-información-previa.html#distribuciones-conjugadas"><span class="toc-section-number">2.1.1</span> Distribuciones conjugadas</a></li>
<li><a href="2-1-información-previa.html#familia-exponencial"><span class="toc-section-number">2.1.2</span> Familia exponencial</a></li>
<li><a href="2-1-información-previa.html#distribuciones-previas-no-informativas"><span class="toc-section-number">2.1.3</span> Distribuciones previas no informativas</a></li>
</ul></li>
<li><a href="2-2-pruebas-de-hipótesis.html#pruebas-de-hipótesis"><span class="toc-section-number">2.2</span> Pruebas de hipótesis</a>
<ul>
<li><a href="2-2-pruebas-de-hipótesis.html#factor-de-bayes"><span class="toc-section-number">2.2.1</span> Factor de Bayes</a></li>
<li><a href="2-2-pruebas-de-hipótesis.html#valor-p-bayesiano"><span class="toc-section-number">2.2.2</span> Valor <span class="math inline">\(p\)</span> Bayesiano</a></li>
<li><a href="2-2-pruebas-de-hipótesis.html#criterio-dic"><span class="toc-section-number">2.2.3</span> Criterio DIC</a></li>
<li><a href="2-2-pruebas-de-hipótesis.html#criterio-aic-y-bic"><span class="toc-section-number">2.2.4</span> Criterio AIC y BIC</a></li>
<li><a href="2-2-pruebas-de-hipótesis.html#acerca-de-la-notación"><span class="toc-section-number">2.2.5</span> Acerca de la notación</a></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="información-previa" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Información previa</h2>
<p>La escogencia de una distribución previa es muy importante en el
análisis bayesiano, puesto que ésta afecta directamente en la
distribución posterior, tal como lo ilustra el teorema de Bayes. En
primer lugar, la distribución previa debe describir adecuadamente los
conocimientos previos sobre los parámetros objetivos de estimación. Por
ejemplo, si se cree que un parámetro toma valores cercanos a 10,
entonces la distribución escogida para representarla también debe tomar
valores cercanos a 10, por ejemplo, una distribución normal centrada en
ese valor. Por otro lado, dado que en la literatura existe un gran
número de distribuciones, algunas muy similares entre ellas, a la hora
de escoger una distribución previa también debe tener en cuenta las
implicaciones a la hora de efectuar cálculos de la estimación puntual o
de intervalo de crediblidad, procurando en la mayoría de casos, obtener
una distribución posterior fácil de manejar. A continuación exponemos
algunos aspectos generales relacionados con esta distribución previa.</p>
<div id="distribuciones-conjugadas" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Distribuciones conjugadas</h3>
<p>Como se verá en los capítulos siguientes, muchos problemas de inferencia
bayesiana comparten la agradable cualidad de que la forma funcional de
la distribución <em>previa</em> para el parámetro de interés resulta ser
la misma de la distribución <em>posterior</em>. Por ejemplo:</p>
<p>Cuando se tiene una muestra aleatoria de variables con distribución
Bernoulli de parámetro <span class="math inline">\(\theta\)</span>, es factible pensar que una distribución
<em>previa</em> apropiada para este parámetro es la distribución Beta;
bajo este escenario, la distribución <em>posterior</em> también resulta
ser Beta.</p>
<p>En el caso en que se quiera modelar el parámetro <span class="math inline">\(\theta\)</span> concerniente a
una variable aleatoria con distribución Poisson, es posible asignar como
candidata para distribución <em>previa</em> a la distribución Gamma; en
este caso la distribución <em>posterior</em> también resulta ser Gamma.</p>
<p>Las distribuciones conjugadas son deseadas en el análisis bayesiano pues
en primer lugar, la distribución posterior del parámetro <span class="math inline">\(\theta\)</span> es
considerada como la actualización del conocimiento acerca de este
después de la recolección de los datos, entonces al tener la misma forma
funcional que la distribución previa, puede ser comparada a ésta y así
ver claramente cómo es la influencia de los datos observados sobre la
creencia acerca de <span class="math inline">\(\theta\)</span>; en segundo lugar, el hecho de que la
distribución posterior sea de la misma forma funcional que la previa
permite que la actualización de información se pueda llevar a cabo
sistemáticamente, pues cada vez que se observan nuevos datos, la
anterior distribución posterior puede ser tomada como la distribución
previa y así producir una nueva distribución posterior.</p>
<p>A continuación exponemos la definición rigurosa de las distribuciones
conjungadas y algunos tópicos relacionados.</p>

<div class="definition">
<span id="def:unnamed-chunk-1" class="definition"><strong>Definición 2.1  </strong></span>Sea <span class="math inline">\(\mathcal{F}=\{p(\mathbf{Y} \mid \boldsymbol \theta)\}\)</span> una familia de distribuciones de probabilidad. Una familia de distribuciones <span class="math inline">\(\mathcal{P}\)</span> se dice conjugada con respecto a <span class="math inline">\(\mathcal{F}\)</span> si para toda distribución <em>previa</em> <span class="math inline">\(p(\boldsymbol \theta) \in \mathcal{P}\)</span> y para toda distribución de muestreo o verosimilitud de las observaciones <span class="math inline">\(p(\mathbf{Y} \mid \boldsymbol \theta)\)</span>, <span class="math inline">\(p(\boldsymbol \theta\mid \mathbf{Y})\)</span> también pertenece a la familia <span class="math inline">\(\mathcal{P}\)</span>.
</div>
<p>Esta definición es en la mayoría de los casos prácticos muy útil. Sin
embargo, <span class="citation"><label for="tufte-mn-3" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-3" class="margin-toggle">Migon y Gamerman (1999)<span class="marginnote">Migon, H. S., y D. Gamerman. 1999. <em>Statistical Inference: An Integrated Approach</em>. Arnold.</span></span> describe los siguientes dos casos en donde
esta definición es completamente inútil:</p>
<p>(Caso amplio) Sea
<span class="math inline">\(\mathcal{P}=\{\emph{Todas las distribuciones de probabilidad}\}\)</span> y
<span class="math inline">\(\mathcal{F}\)</span> cualquier familia de distribuciones de probabilidad.
Entonces <span class="math inline">\(\mathcal{P}\)</span> es conjugada con respecto a <span class="math inline">\(\mathcal{F}\)</span> puesto
que toda posible distribución <em>posterior</em> será un miembro de
<span class="math inline">\(\mathcal{P}\)</span>.</p>
<p>(Caso restringido) Sea <span class="math inline">\(\mathcal{P}=\{p \mid p(\theta=\theta_0)=1\}\)</span>,
esto es, <span class="math inline">\(\mathcal{P}\)</span> corresponde a todas las distribuciones
concentradas en un punto. Sea <span class="math inline">\(\mathcal{F}\)</span> cualquier familia de
distribuciones de probabilidad. De esta manera, la distribución
<em>posterior</em> de <span class="math inline">\(\theta\)</span> estará dada por <span class="math display">\[\begin{align*}
    p(\theta \mid Y)\propto
    p(Y \mid \theta)p(\theta)
    &amp;=
    \begin{cases}
    p(Y \mid \theta)\times 1 \ \ \ \ \text{si $\theta=\theta_0$}\\
    p(Y \mid \theta)\times 0 \ \ \ \ \text{si $\theta\neq\theta_0$}\\
    \end{cases}\\
    &amp;=
    \begin{cases}
    p(Y \mid \theta) \ \ \ \ \text{si $\theta=\theta_0$}\\
    0           \ \ \ \ \text{si $\theta\neq\theta_0$}\\
    \end{cases}
    \end{align*}\]</span></p>
<p>De lo anterior y dado que <span class="math inline">\(\int p(\theta \mid Y)\ d\theta=1\)</span>, entonces
<span class="math inline">\(p(Y \mid \theta)=1\)</span> si y sólo si <span class="math inline">\(\theta=\theta_0\)</span>. Con el anterior
razonamiento, se concluye que <span class="math inline">\(\mathcal{P}\)</span> es conjugada con respecto a
<span class="math inline">\(\mathcal{F}\)</span>.</p>
<p>Por lo tanto, se deben buscar distribuciones <em>previa</em> que sean
conjugadas de una forma tan amplia que permita proponer una distribución
<em>previa</em> adecuada, pero al mismo tiempo tan restringida para que la
definición de conjugada tenga sentido práctico. Ahora introducimos una
familia de distribuciones muy importante para el desarrollo de la teoría
estadística, tanto en el ámbito bayesiano como en el clásico.</p>
</div>
<div id="familia-exponencial" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Familia exponencial</h3>
<p>Dependiendo de la naturaleza del parámetro <span class="math inline">\(\theta\)</span>, la familia
exponencial puede ser uniparamétrica o multiparamétrica. En el primer
caso, una distribución de probabilidad pertenece a la familia
exponencial uniparamétrica si se puede escribir de la forma
<span class="math display">\[\begin{equation}\label{uniexpo}
p(Y \mid \theta)=\exp\{d(\theta)T(y)-c(\theta)\}h(y)
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(T(y)\)</span> y <span class="math inline">\(h(y)\)</span> son funciones que dependen de <span class="math inline">\(y\)</span> únicamente, y
<span class="math inline">\(d(\theta)\)</span> y <span class="math inline">\(c(\theta)\)</span> son funciones que depende de <span class="math inline">\(\theta\)</span>
únicamente. Análogamente, una distribución de probabilidad pertenece a
la familia exponencial multi-paramétrica si se puede escribir de la
forma <span class="math display">\[\begin{equation}\label{multiexpo}
p(Y \mid \boldsymbol \theta)=\exp\{\mathbf{d}(\boldsymbol \theta)&#39;\mathbf{T}(y)-c(\boldsymbol \theta)\}h(y)
\end{equation}\]</span> donde <span class="math inline">\(\mathbf{T}(y)\)</span> y <span class="math inline">\(\mathbf{d}(\boldsymbol \theta)\)</span> son
funciones vectoriales, <span class="math inline">\(h(y)\)</span> y <span class="math inline">\(c(\boldsymbol \theta)\)</span> son funciones reales.</p>
<p>La ventaja de la familia exponencial radica en que es una familia
relativamente restringuida de distribuciones y a la vez conserva la
propiedad de ser distribuciones conjugadas, tal como muestra el
siguiente resultado:</p>

<div class="proposition">
<span id="prp:unnamed-chunk-2" class="proposition"><strong>Resultado 2.1  </strong></span>Sea <span class="math inline">\(Y\)</span> una variable aleatoria con función de densidad perteneciente a la familia exponencial uniparamétrica, entonces la familia exponencial uniparamétrica es conjugada con respecto a sí misma.
</div>

<div class="proof">
<p> <span class="proof"><em>Prueba. </em></span> Observando la expresión (1.5.1), se debe encontrar una distribución <em>previa</em> en la familia exponencial uniparamétrica, tal que la distribución <em>posterior</em>, resultante del producto de la distribución <em>previa</em> con la verosimilitud, sea también miembro de la familia exponencial uniparamétrica. Con base en lo anterior, la distribución <em>previa</em>, parametrizada por el hiperparámetro <span class="math inline">\(\alpha\)</span>, debe ser una función exponencial de los términos <span class="math inline">\(d(\theta)\)</span> y <span class="math inline">\(c(\theta)\)</span> como lo afirma <span class="citation"><label for="tufte-mn-4" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-4" class="margin-toggle">Jordan (2004)<span class="marginnote">Jordan, M. I. 2004. <span>«The Exponential Family and Generalized Linear Models»</span>.</span></span>. Esto es,
<span class="math display">\[\begin{equation}
p(\theta \mid \alpha)\propto\exp\{w(\alpha) d(\theta)-\delta c(\theta)\},
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(\delta\)</span> es una constante real (posiblemente dependiente de <span class="math inline">\(\alpha\)</span>). Por otro lado, para garantizar que <span class="math inline">\(p(\theta \mid \alpha)\)</span> sea una auténtica función de densidad se normaliza de la siguiente manera
<span class="math display">\[\begin{equation}
p(\theta \mid \alpha)=\frac{1}{k(\alpha,\delta)}\exp\{w(\alpha) d(\theta)-\delta c(\theta)\},
\end{equation}\]</span></p>
<p>con
<span class="math display">\[\begin{equation*}
k(\alpha,\delta)=\int\exp\{w(\alpha) d(\theta)-\delta c(\theta)\} \ d\theta.
\end{equation*}\]</span></p>
<p>De esta manera, no es difícil comprobar que la definición de distribución <em>previa</em>, parametrizada por el hiper-parámetro <span class="math inline">\(\alpha\)</span>, pertenece a la familia exponencial, puesto que
<span class="math display">\[\begin{equation}
p(\theta \mid \alpha)=\exp\{\underbrace{w(\alpha)}_{d(\alpha)} \underbrace{d(\theta)}_{T(\theta)} - \underbrace{\ln k(\alpha,\delta)}_{c(\alpha)}\}\underbrace{\exp\{-\delta c(\theta)\}}_{h(\theta)}.
\end{equation}\]</span></p>
<p>Por otro lado, del teorema de Bayes se tiene que
<span class="math display">\[\begin{align*}
p(\theta \mid Y) &amp;\propto p(Y \mid \theta)p(\theta \mid \alpha)\\
&amp;=\exp\{w(\alpha) d(\theta) + d(\theta)T(y) - c(\theta) -\ln k(\alpha,\delta) \}\exp\{-\delta c(\theta)\}h(y)\\
&amp;=\exp\{\underbrace{[\alpha+T(y)]}_{d(y)} \underbrace{d(\theta)}_{T(\theta)} -\underbrace{[\ln k(\alpha,\delta)-\ln h(y)]}_{c(y)}\} \underbrace{\exp\{-(\delta+1) c(\theta)\}}_{h(\theta)}\\
&amp;\propto \exp\{[w(\alpha)+T(y)] d(\theta)\}\exp\{-(\delta+1) c(\theta)\}.
\end{align*}\]</span></p>
Por lo tanto, la distribución <em>posterior</em> resultante también pertenece a la familia exponencial uniparamétrica.
</div>
<p>La extensión del anterior resultado para el caso cuando tenemos una
muestra aleatoria de observaciones es sencilla, tal como se expone a
continuación:</p>

<div class="proposition">
<span id="prp:unnamed-chunk-4" class="proposition"><strong>Resultado 2.2  </strong></span>Sean <span class="math inline">\(\mathbf{Y}=\{Y_1, \ldots, Y_n\}\)</span> una muestra aleatoria de variables distribuidas con función de densidad común perteneciente a la familia exponencial uniparamétrica, cuya función de densidad conjunta <span class="math inline">\(p(\mathbf{Y} \mid \theta)\)</span> también pertenece a la familia exponencial uniparamétrica. Bajo las anteriores condiciones la familia exponencial uniparamétrica es conjugada con respecto a sí misma.
</div>

<div class="proof">
 <span class="proof"><em>Prueba. </em></span> La demostración es inmediata utilizando el resultado anterior y notando que la forma funcional de la densidad conjunta para <span class="math inline">\(\mathbf{Y}\)</span> es
<span class="math display">\[\begin{equation}
p(\mathbf{Y} \mid \theta)=\exp\left\{d(\theta)\sum_{i=1}^nT(y_i)-nc(\theta)\right\}\prod_{i=1}^nh(y_i)
\end{equation}\]</span>
la cual hace parte de la familia exponencial.
</div>
<p>Otra extensión del resultado  corresponde al caso cuando la
distribución de la observación está reparametrizado por un vector de
parámetros <span class="math inline">\(\boldsymbol \theta\)</span>. A continuación se expone el resultado y la prueba
correspondiente.</p>

<div class="proposition">
<span id="prp:unnamed-chunk-6" class="proposition"><strong>Resultado 2.3  </strong></span>Sean <span class="math inline">\(Y\)</span> una variable aleatoria con función de densidad perteneciente a la familia exponencial multiparamétrica. Sea <span class="math inline">\(\boldsymbol \theta\)</span> el parámetro de interés con distribución <em>previa</em> parametrizada por un vector de hiperparámetros <span class="math inline">\(\boldsymbol \eta\)</span> y perteneciente a la familia exponencial multiparamétrica. Entonces la familia exponencial multiparamétrica es conjugada con respecto a sí misma.
</div>

<div class="proof">
<p> <span class="proof"><em>Prueba. </em></span> En primer lugar, la distribución de probabilidad de <span class="math inline">\(Y\)</span> perteneciente a la familia exponencial multiparamétrica está dada por (1.5.2). Siguiendo el mismo razonamiento de la demostración del Resultado 1.5.1, la distribución <em>previa</em> del parámetro de interés debe estar definida de la siguiente manera
<span class="math display">\[\begin{equation}
p(\boldsymbol \theta\mid \boldsymbol \eta)=\exp\left\{\underbrace{w(\boldsymbol \eta)&#39;}_{\mathbf{d}(\boldsymbol \eta)}
\underbrace{\mathbf{d}(\boldsymbol \theta)}_{\mathbf{T}(\boldsymbol \theta)} - \underbrace{\ln k(\boldsymbol \eta,\delta)}_{c(\boldsymbol \eta)}\right\}\underbrace{\exp\{-\delta c(\boldsymbol \theta)\}}_{h(\boldsymbol \theta)},
\end{equation}\]</span></p>
<p>con
<span class="math display">\[\begin{equation*}
k(\boldsymbol \eta,\delta)=\int\exp\{w(\boldsymbol \eta)&#39;\mathbf{d}(\boldsymbol \theta)-\delta c(\boldsymbol \theta)\} \ d\boldsymbol \theta.
\end{equation*}\]</span></p>
<p>Utilizando el teorema de Bayes, se tiene que, la distribución <em>posterior</em> del parámetro <span class="math inline">\(\theta\)</span> es
<span class="math display">\[\begin{align*}
p(\boldsymbol \theta\mid Y) &amp;\propto p(Y \mid \boldsymbol \theta)p(\boldsymbol \theta\mid \boldsymbol \eta)\\
&amp;= \exp\{\mathbf{T}(y)&#39;\mathbf{d}(\boldsymbol \theta) - c(\boldsymbol \theta) + w(\boldsymbol \eta)&#39; \mathbf{d}(\boldsymbol \theta) - \delta c(\boldsymbol \theta) - \ln k(\boldsymbol \eta,\delta) +\ln h(y)\}\\
&amp; =
\exp\left\{\underbrace{(w(\boldsymbol \eta)+\mathbf{T}(y))&#39;}_{\mathbf{d}(y)}
\underbrace{\mathbf{d}(\boldsymbol \theta)}_{\mathbf{T}(\theta)} - \underbrace{\left[\ln k(\boldsymbol \eta,\delta)-\ln h(y)\right]}_{c(y)}\right\}\underbrace{\exp\{-(\delta+1)c(\boldsymbol \theta)\}}_{h(\boldsymbol \theta)}
\end{align*}\]</span></p>
La anterior expresión también hace parte de la familia exponencial biparamétrica y con esto se concluye la demostración
</div>
<p>Nótese que el anterior resultado también cobija situaciones donde la
verosimilitud sea perteneciente a la familia exponencial uniparamétrica.
Más aún, a cualquier familia exponencial multiparamétrica de orden menor
o igual al orden de la distribución <em>previa</em>.</p>

<div class="proposition">
<span id="prp:unnamed-chunk-8" class="proposition"><strong>Resultado 1.2  </strong></span>Sean <span class="math inline">\(\mathbf{Y}=\{Y_1, \ldots, Y_n\}\)</span> una muestra aleatoria con función de densidad conjunta o verosimilitud dada (1.4.4). Bajo este escenario la familia exponencial multi-paramétrica es conjugada con respecto a sí misma.
</div>

<div class="proof">
 <span class="proof"><em>Prueba. </em></span> La demostración sigue los mismos lineamentos que la demostración del resultado anterior concluyendo que la distribución <em>posterior</em> de <span class="math inline">\(\boldsymbol \theta\)</span> está dada por
<span class="math display">\[\begin{align*}
&amp;p(\boldsymbol \theta\mid \mathbf{Y}) \propto p(\mathbf{Y} \mid \boldsymbol \theta)p(\boldsymbol \theta\mid \boldsymbol \eta)\\
&amp;= \exp\left\{\sum_{i=1}^n\mathbf{T}(y_i)&#39;\mathbf{d}(\boldsymbol \theta) - nc(\boldsymbol \theta) + \boldsymbol \eta&#39; \mathbf{d}(\boldsymbol \theta) - \delta c(\boldsymbol \theta) - \ln k(\boldsymbol \eta,\delta) +\sum_{i=1}^n\ln h(y_i)\right\}\\
&amp; =\exp\left\{\underbrace{\left(\boldsymbol \eta+\sum_{i=1}^n\mathbf{T}(y_i)\right)&#39;}_{\mathbf{d}(\mathbf{y})}
\underbrace{\mathbf{d}(\boldsymbol \theta)}_{\mathbf{T}(\theta)} - \underbrace{\left[\ln k(\boldsymbol \eta,\delta)-\sum_{i=1}^n\ln h(y_i)\right]}_{c(\mathbf{y})}\right\} \\
&amp;  \times \underbrace{\exp\left\{-(\delta+n)c(\boldsymbol \theta)\right\}}_{h(\boldsymbol \theta)}
\end{align*}\]</span>
La anterior expresión también hace parte de la familia exponencial.
</div>
<p>Ahora, estudiamos las expresiones relacionadas con la distribución
predictiva de nuevas observaciones dentro del contexto de la familia
exponencial:</p>

<div class="proposition">
<p><span id="prp:unnamed-chunk-10" class="proposition"><strong>Resultado 1.3  </strong></span>Sea <span class="math inline">\(Y\)</span> una variable aleatoria con función de densidad perteneciente a la familia exponencial, dada por (). Sea <span class="math inline">\(\theta\)</span> el parámetro de interés con distribución <em>previa</em> en la familia exponencial biparamétrica. La distribución predictiva <em>previa</em> de <span class="math inline">\(Y\)</span> está dada por
<span class="math display">\[\begin{equation}
p(Y)=\frac{k(\alpha+T(y),\delta+1)}{k(\alpha,\delta)}h(y)
\end{equation}\]</span></p>
donde
<span class="math display">\[\begin{equation*}
k(a,b)=\int \exp\{w(a) d(\theta)-b c(\theta)\}\ d\theta
\end{equation*}\]</span>
</div>

<div class="proof">
<p> <span class="proof"><em>Prueba. </em></span> <span class="math display">\[\begin{align*}
p(Y)&amp;=\int p(\theta)p(Y \mid \theta)\ d\theta\\
&amp;=\int \exp\{w(\alpha) d(\theta)-\ln k(\alpha,\delta)-\delta c(\theta)\}\exp\{d(\theta)T(y)-c(\theta)\}h(y)d\theta\\
&amp;=\frac{h(y)}{k(\alpha,\delta)}\int \exp\{[w(\alpha)+T(y)]d(\theta)-(\delta+1)c(\theta)\}d\theta\\
&amp;=\frac{k(\alpha+T(y),\delta+1)h(y)}{k(\alpha,\delta)}
\end{align*}\]</span></p>
<p>donde
<span class="math display">\[\begin{equation*}
k(\alpha,\delta)=\int \exp\{w(\alpha) d(\theta)-\delta c(\theta)\}\ d\theta
\end{equation*}\]</span></p>
y
<span class="math display">\[\begin{equation*}
k(\alpha+T(y),\delta+1)=\int \exp\{[w(\alpha)+T(y)]d(\theta)-(\delta+1)c(\theta)\} \ d\theta.
\end{equation*}\]</span>
</div>
<p>La extensión al caso de contar con una muestra aleatoria de
observaciones se encuentra a continuación:</p>

<div class="proposition">
<p><span id="prp:unnamed-chunk-12" class="proposition"><strong>Resultado 1.4  </strong></span>Sea <span class="math inline">\(\mathbf{Y}=\{Y_1\ldots,Y_n\}\)</span> una muestra aleatoria con función de densidad conjunta perteneciente a la familia exponencial, dada por (1.4.4). Sea <span class="math inline">\(\theta\)</span> el parámetro de interés con distribución <em>previa</em> dada por (1.4.5). La distribución predictiva <em>previa</em> de <span class="math inline">\(\mathbf{Y}\)</span> está dada por</p>
<span class="math display">\[\begin{equation}
p(\mathbf{Y})=\frac{k(\alpha+T(\mathbf{y}),\delta+n)}{k(\alpha,\beta)}h(\mathbf{y})
\end{equation}\]</span>
donde <span class="math inline">\(k\)</span> se define tal como en el resultado anterior.
</div>

<div class="proof">
 <span class="proof"><em>Prueba. </em></span> La prueba se tiene de inmediato siguiendo los lineamentos de la demostración del anterior resultado.
</div>

<div class="proposition">
<span id="prp:unnamed-chunk-14" class="proposition"><strong>Resultado 2.4  </strong></span>En términos de la distribución predictiva <em>posterior</em>, se tiene que para una sola observación <span class="math inline">\(\tilde{y}\)</span>, ésta está dada por
<span class="math display">\[\begin{equation}
p(\tilde{y} \mid Y)=\frac{k(\alpha+T(y)+T(\tilde{y}),\delta+2)}{k(\alpha+T(y),\delta+1)}h(\tilde{y})
\end{equation}\]</span>
y en el caso en donde se tiene una muestra aleatoria, entonces la distribución predictiva <em>posterior</em> para una nueva muestra <span class="math inline">\(\tilde{\mathbf{y}}=\{\tilde{y}_1,\ldots,\tilde{y}_{n^*}\}\)</span> de tamaño <span class="math inline">\(n^*\)</span> está dada por
<span class="math display">\[\begin{equation}
p(\tilde{\mathbf{y}} \mid \mathbf{Y})=
\frac{k(\alpha+T(\mathbf{y})+T(\tilde{\mathbf{y}}),\delta+n+n^*)}
{k(\alpha+T(\mathbf{y}),\delta+n)}h(\tilde{\mathbf{y}})
\end{equation}\]</span>
</div>

<div class="proof">
<p> <span class="proof"><em>Prueba. </em></span> De la definición de distribución predictiva <em>posterior</em> dada por la expresión () se tiene que
<span class="math display">\[\begin{align*}
p(\tilde{y} \mid Y)&amp;=\int p(\tilde{y} \mid \theta)p(\theta \mid y)\ d\theta\\
&amp;=\int \exp\{d(\theta)T(\tilde{y})-c(\theta)\}h(\tilde{y})\dfrac{\exp\{[w(\alpha)+T(y)]d(\theta)-(\delta+1)c(\theta)\}}{k(\alpha+T(y),\delta+1)}\ d\theta\\
&amp;=\frac{h(\tilde{y})}{k(w(\alpha)+T(y),\delta+1)}\int \exp\{[\alpha+T(y)+T(\tilde{y})]d(\theta)-(\delta+2)c(\theta)\}\ d\theta\\
&amp;=\frac{k(\alpha+T(y)+T(\tilde{y}),\delta+2)}{k(\alpha+T(y),\delta+1)}h(\tilde{y}),
\end{align*}\]</span></p>
<p>con
<span class="math display">\[\begin{equation*}
k(\alpha+T(y)+T(\tilde{y}),\delta+2)=\int \exp\{[w(\alpha)+T(y)+T(\tilde{y})]d(\theta)-(\delta+2)c(\theta)\}\ d\theta.
\end{equation*}\]</span></p>
La demostración para la nueva muestra se lleva a cabo de manera análoga.
</div>
</div>
<div id="distribuciones-previas-no-informativas" class="section level3" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Distribuciones previas no informativas</h3>
<p>Cuando no existe una base poblacional sobre el parámetro de interés o
cuando existe total ignorancia de parte del investigador acerca del
comportamiento de probabilístico del parámetro, es necesario definir
distribuciones <em>previa</em> que sean no informativas. Es decir, definir
distribuciones <em>previa</em> que jueguen un papel mínimo en términos de
influencia en la distribución <em>posterior</em>. Una característica de
estas distribuciones es que su forma es vaga, plana o difusa, cumpliendo
así el objetivo de no influenciar a la distribución <em>posterior</em>.
Por tanto la pregunta de interés que surge en este instante es: ¿cómo
seleccionar distribuciones <em>previa</em> no
informativas<label for="tufte-sn-4" class="margin-toggle sidenote-number">4</label><input type="checkbox" id="tufte-sn-4" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">4</span> Existen muchas denominaciones para las distribuciones uniformes que no son informativas. Por ejemplo, Box Tiao proponen el nombre de distribuciones localmente uniformes para asegurar que cumplan con las condiciones de función de densidad de probabilidad en un rango particular del espacio paramétrico. Sin embargo, en este texto vamos a utilizar la expresión &lt;<no informativa>&gt; al referirse a este tipo de distribuciones a previa.</span>
sobre el parámetro de interés?</p>
<p>En los anteriores términos, la distribución uniforme define una
distribución <em>previa</em> que cumple con las características de no
información en la mayoría de escenarios. Específicamente en aquellos
problemas en donde el parámetro de interés está limitado a un espacio de
muestreo acotado. Por ejemplo, en la distribución Binomial, el parámetro
de interés está limitado al espacio de muestreo <span class="math inline">\([0,1]\)</span>. Sin embargo, no
en todos los problemas encaja la distribución uniforme. Nótese, por
ejemplo, que en el caso en que la distribución exponencial se acomode a
los datos como candidata a verosimilitud, entonces el espacio de
muestreo del parámetro de interés estaría dado por <span class="math inline">\((0,\infty)\)</span> en cuyo
caso la distribución uniforme no sería conveniente puesto que sería una
distribución impropia en el espacio de muestreo del parámetro de
interés. Es decir <span class="math display">\[\begin{equation*}
\text{si } p(\theta)\propto kI_{\Theta}(\theta) \text{, entonces } \int_{\Theta}p(\theta) \ d(\theta)\longrightarrow \infty.
\end{equation*}\]</span></p>
<p>donde <span class="math inline">\(\Theta\)</span> denota espacio de muestreo del parámetro <span class="math inline">\(\theta\)</span> y <span class="math inline">\(I\)</span>
denota la función indicadora. Por otro lado, una característica
importante que debe tener una distribución <em>previa</em> no informativa
es que sea invariante en términos de transformaciones matemáticas. Es
decir, si el parámetro de interés es <span class="math inline">\(\theta\)</span> con distribución
<em>previa</em> no informativa dada por <span class="math inline">\(p(\theta)\)</span>, y sea
<span class="math inline">\(\phi=h(\theta)\)</span> una transformaición de <span class="math inline">\(\theta\)</span> por medio de la función
<span class="math inline">\(h\)</span>, entonces la distribución <em>previa</em> de <span class="math inline">\(\phi\)</span> también debería
ser no informativa. Sin embargo, la teoría de probabilidad afirma que la
distribución de probabilidad de una transformación está dada por
<span class="math display">\[\begin{equation}\label{teo_transf}
p(\phi)=p(\theta) \mid \frac{d\theta}{d\phi} \mid =p(\theta) \mid h&#39;(\theta) \mid ^{-1}
\end{equation}\]</span></p>
<p>y claramente si la función <span class="math inline">\(h\)</span> no es una función lineal, entonces los
resultados encontrados por medio de este enfoque indicarían que la
distribución <em>previa</em> <span class="math inline">\(p(\phi)\)</span> sería informativa contradiciendo
los supuestos de <span class="math inline">\(p(\theta)\)</span>. El siguiente ejemplo ilustra este
planteamiento:</p>

<div class="example">
<p><span id="exm:unnamed-chunk-16" class="example"><strong>Ejemplo 2.1  </strong></span>Suponga que el parámetro de interés es <span class="math inline">\(\theta\)</span> y que está restringido a un espacio de muestreo dado por el intervalo <span class="math inline">\([0,1]\)</span>. Si se supone completa ignorancia acerca del comportamiento del parámetro, entonces una buena opción, con respecto a la distribución <em>previa</em>, sería la distribución uniforme en el intervalo <span class="math inline">\([0,1]\)</span>. Es decir, la distribución <em>previa</em> no informativa estaría dada por
<span class="math display">\[\begin{equation*}
p(\theta) = I_{[0,1]}(\theta)
\end{equation*}\]</span></p>
<p>Suponga ahora que existe una transformación del parámetro de interés dada por <span class="math inline">\(\phi=h(\theta)=\ln(\theta)\)</span>. Por tanto, siguiendo () se tiene que la distribución de <span class="math inline">\(\phi\)</span> está dada por
<span class="math display">\[\begin{equation*}
p(\phi)=I_{(-\infty,0)}(\phi)e^{\phi}
\end{equation*}\]</span></p>
la cual es informativa con respecto al parámetro <span class="math inline">\(\phi\)</span>. Sin embargo, es el mismo problema y existe una contradicción en términos de que para <span class="math inline">\(\theta\)</span> se desconoce todo, pero para una función <span class="math inline">\(\phi\)</span> existe evidencia de que el parámetro se comporta de cierta manera.
</div>
<p>Para palear las anteriores diferencias, es necesario encontrar una
distribución <em>previa</em> no informativa que sea invariante a
transformaciones matemáticas. La distribución <em>previa</em> no
informativa de Jeffreys, definida a continuación, cuenta con esta
agradable propiedad.</p>

<div class="definition">
<p><span id="def:unnamed-chunk-17" class="definition"><strong>Definición 2.2  </strong></span>Si la verosimilitud de los datos está determinada por un único parámetro <span class="math inline">\(\theta\)</span>, la distribución <em>previa</em> no informativa de Jeffreys tiene distribución de probabilidad dada por
<span class="math display">\[\begin{equation}
p(\theta)\propto (I(\theta))^{1/2}
\end{equation}\]</span></p>
<p>con <span class="math inline">\(I(\theta)\)</span> la información de Fisher definida como
<span class="math display">\[\begin{align*}
I(\theta)&amp;=E\left\{\left[\frac{\partial}{\partial\theta}\log{p(\mathbf{Y}\mid\theta)}\right]^2\right\}\\
&amp;=-E\left\{\dfrac{\partial^2}{\partial\theta^2}\log{p(\mathbf{Y}\mid\theta)}\right\}
\end{align*}\]</span></p>
<p>Si la verosimilitud de los datos está determinada por un vector de parámetros <span class="math inline">\(\boldsymbol \theta\)</span>, la distribución <em>previa</em> no informativa de Jeffreys tiene distribución de probabilidad dada por
<span class="math display">\[\begin{equation}
p(\theta)\propto |\mathbf{I}(\boldsymbol \theta)|^{1/2}
\end{equation}\]</span></p>
donde <span class="math inline">\(\mathbf{I}\)</span> es la matriz de información de Fisher, cuyo elemento en la fila <span class="math inline">\(i\)</span> y columna <span class="math inline">\(j\)</span> está definida como
<span class="math display">\[\begin{align*}
\mathbf{I}_{[ij]}(\boldsymbol \theta)&amp;=E\left\{\left[\frac{\partial}{\partial\theta_i}\log{p(\mathbf{Y}\mid\theta)}\right]\left[\frac{\partial}{\partial\theta_j}\log{p(\mathbf{Y}\mid\boldsymbol \theta)}\right]\right\}\\
&amp;=-E\left\{\dfrac{\partial^2}{\partial\theta_i\partial\theta_j}\log{p(\mathbf{Y}\mid\boldsymbol \theta)}\right\}
\end{align*}\]</span>
donde <span class="math inline">\(\theta_i\)</span> y <span class="math inline">\(\theta_j\)</span> son los elementos <span class="math inline">\(i\)</span> y <span class="math inline">\(j\)</span> del vector <span class="math inline">\(\boldsymbol \theta\)</span>.
</div>
<p>Nótese que si la verosimilitud de las observaciones pertenecen a la
familia de distribuciones exponencial, entonces la distribución previa
de Jeffreys no es difícil de calcular. Por otro lado nótese que la
distribución previa no informativa de Jeffreys depende, de cierta
manera, del mecanismo probabilístico que rige a los datos. Lo anterior
hace que ciertos críticos de la estadística bayesiana critiquen este
enfoque puesto que se supone que la formulación de la distribución a
previa es independiente de los datos observados.</p>
<p>A continuación se evidencia la propiedad de esta distribución previa de
seguir siendo no informativa con diferentes parametrizaciones.</p>

<div class="proposition">
<span id="prp:unnamed-chunk-18" class="proposition"><strong>Resultado 2.5  </strong></span>La distribución <em>previa</em> no informativa de Jeffreys es invariante a transformaciones uno a uno. Es decir, si <span class="math inline">\(\phi=h(\theta)\)</span>, entonces <span class="math inline">\(p(\phi)\propto(I(\phi))^{1/2}\)</span>.
</div>

<div class="proof">
<p> <span class="proof"><em>Prueba. </em></span> En primer lugar nótese que
<span class="math display">\[\begin{align*}
I(\theta)=\mathbf{J}(\phi) \mid \frac{\partial\phi}{\partial\theta} \mid ^{2}
\end{align*}\]</span></p>
<p>puesto que al utilizar la regla de la cadena del cálculo matemático se tiene que
<span class="math display">\[\begin{align*}
\mathbf{J}(\phi)= - E\left[\frac{\partial^2 \log p(\mathbf{Y} \mid \phi)}{\partial\phi^2}\right]
&amp;= - E\left[\frac{\partial}{\partial\phi}\left(\frac{\partial \log p(\mathbf{Y} \mid \phi)}{\partial\phi}\right)\right]\\
&amp;= - E\left[\frac{\partial}{\partial\theta}\left(\frac{\partial \log p(\mathbf{Y} \mid \phi)}{\partial\phi}\right) \mid \frac{\partial\theta}{\partial\phi} \mid \right]\\
&amp;= - E\left[\frac{\partial^2 \log p(\mathbf{Y} \mid \phi)}{d\theta^2} \mid \frac{\partial\theta}{\partial\phi} \mid ^{2}\right]\\
&amp;= - E\left[\frac{\partial^2 \log p(\mathbf{Y} \mid \theta =h^{-1}(\phi))}{d\theta^2} \mid \frac{\partial\theta}{\partial\phi} \mid ^{2}\right]\\
&amp;= I(\theta) \mid \frac{\partial\theta}{\partial\phi} \mid ^{2}
\end{align*}\]</span></p>
Ahora, de la definición de función de distribución para una función y utilizando (1.4.11), se tiene que
<span class="math display">\[\begin{align*}
p(\phi)&amp;=p(\theta) \mid \frac{\partial\theta}{\partial\phi} \mid
\propto (I(\theta))^{1/2} \mid \frac{\partial\theta}{\partial\phi} \mid
\propto I(\phi)^{1/2} \mid \frac{\partial\phi}{\partial\theta} \mid  \mid \frac{d\theta}{\partial\phi} \mid =I(\phi)^{1/2}
\end{align*}\]</span>
</div>
<p>En <span class="citation"><label for="tufte-mn-5" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-5" class="margin-toggle">Box y Tiao (1992, 59)<span class="marginnote">Box, G. E. P., y G. C. Tiao. 1992. <em>Bayesian Inference in Statistical Analysis</em>. 1.ª ed. Wiley.</span></span> citan una Tabla de resumen en donde se
encuentran distribuciones a previa no informativas para las
distribuciones probabilísticas más comunes. A continuación se exponen
algunos ejemplos que utilizan este enfoque.</p>

<div class="example">
<span id="exm:unnamed-chunk-20" class="example"><strong>Ejemplo 2.2  </strong></span>Si <span class="math inline">\(Y\)</span> es una variable aleatoria con distribución Binomial, entonces el espacio de muestreo del parámetro de interés será el intervalo <span class="math inline">\([0,1]\)</span>; sería conveniente utilizar la función de distribución uniforme sobre este intervalo como distribución <em>previa</em> no informativa. Con el enfoque de Jeffreys se llega a este mismo resultado puesto que: la información de Fisher para la distribución binomial es <span class="math inline">\(J(\theta)=n/\theta(1- \theta)\)</span> dado que
<span class="math display">\[\begin{equation*}
\log p(Y \mid \theta)=\log \binom{n}{y} + y\log(\theta)+(n-y)\log(1-\theta)
\end{equation*}\]</span>
y
<span class="math display">\[\begin{equation*}
\frac{\partial^2 \log p(Y \mid \theta)}{\partial\theta^2}=-\frac{y}{\theta^2}-\frac{n-y}{(1-\theta)^2}
\end{equation*}\]</span>
Por lo tanto al calcular la esperanza, y por consiguiente la información de Fisher, se tiene que
<span class="math display">\[\begin{equation*}
I(\theta)=- E\left[\frac{d^2 \log p(Y \mid \theta)}{d\theta^2}\right]
=\frac{n\theta}{\theta^2}+\frac{n-n\theta}{(1-\theta)^2}= \frac{n}{\theta(1-\theta)}
\end{equation*}\]</span>
Es decir, la distribución <em>previa</em> no informativa para el parámetro de interés <span class="math inline">\(\theta\)</span> es proporcional a <span class="math inline">\(\theta^{-1/2}(1-\theta)^{-1/2}\)</span>, la cual comparte la misma forma estructural de una distribución <span class="math inline">\(Beta(1/2,1/2)\)</span> que a su vez es idéntica a la distribución uniforme. En términos de la distribución <em>posterior</em> para el parámetro de interés, se tiene que
<span class="math display">\[\begin{align*}
p(\theta \mid Y) &amp;\propto p(Y \mid \theta) p(\theta)\\
&amp;\propto \theta^{y}(1-\theta)^{n-y}\theta^{-1/2}(1-\theta)^{-1/2}\\
&amp;=\theta^{y+1/2-1}(1-\theta)^{n-y+1/2-1}
\end{align*}\]</span>
Por tanto, la distribución de <span class="math inline">\(\theta \mid Y\)</span> es <span class="math inline">\(Beta(y+1/2,n-y+1/2)\)</span>. Por construcción, esta distribución no está alterada ni influenciada por la distribución <em>previa</em> pues la misma es no informativa.
</div>

<div class="example">
<span id="exm:unnamed-chunk-21" class="example"><strong>Ejemplo 2.3  </strong></span>
Si <span class="math inline">\(\mathbf{Y}=\{Y_1,\ldots,Y_n\}\)</span> es una muestra aleatoria de variables con distribución de Poisson, entonces el espacio de muestreo del parámetro de interés será el intervalo <span class="math inline">\((0,\infty)\)</span>; por tanto utilizar la distribución uniforme como distribución <em>previa</em> no informativa no es conveniente. Ahora, la información de Fisher para la distribución conjunta es <span class="math inline">\(I(\theta)=n/\theta\)</span> puesto que
<span class="math display">\[\begin{equation*}
\log p(\mathbf{Y} \mid \theta)=-n\theta+\log(\theta)\sum_{i=1}^ny_i-\sum_{i=1}^n\log(y_i!)
\end{equation*}\]</span>
y
<span class="math display">\[\begin{equation*}
\frac{\partial^2 \log p(\mathbf{Y} \mid \theta)}{\partial\theta^2}=-\frac{\sum_{i=1}^ny_i}{\theta^2}
\end{equation*}\]</span>
Por lo tanto al calcular la esperanza, y por consiguiente la información de Fisher, se tiene que
<span class="math display">\[\begin{equation*}
I(\theta)=- E\left[\frac{\partial^2 \log p(\mathbf{Y} \mid \theta)}{\partial\theta^2}\right]
=\frac{\sum_{i=1}^nE(y_i)}{\theta^2}=\frac{n}{\theta}
\end{equation*}\]</span>
Es decir, la distribución <em>previa</em> no informativa para el parámetro de interés es proporcional a <span class="math inline">\(\theta^{-1/2}\)</span>. En términos de la distribución <em>posterior</em> para el parámetro de interés, se tiene que
<span class="math display">\[\begin{align*}
p(\theta \mid Y) \propto p(Y \mid \theta) p(\theta) \propto e^{-n\theta} \theta^{\sum_{i=1}^ny_i}\theta^{-1/2}
=e^{-n\theta} \theta^{\sum_{i=1}^ny_i-1/2}
\end{align*}\]</span>
Por tanto, la distribución de <span class="math inline">\(\theta \mid \mathbf{Y}\)</span> es <span class="math inline">\(Gamma(\sum_{i=1}^ny_i+1/2,n)\)</span>. Por construcción, esta distribución no está alterada ni influenciada por la distribución <em>previa</em> pues la misma es no informativa.
</div>

<div class="example">
<p><span id="exm:unnamed-chunk-22" class="example"><strong>Ejemplo 2.4  </strong></span>Suponga que <span class="math inline">\(\mathbf{Y}=\{Y_1\ldots, Y_n\}\)</span> es una muestra aleatoria con distribución normal de parámetros <span class="math inline">\((\theta, \sigma^2)&#39;\)</span>. Se puede verificar que la matriz de información de Fisher para el vector de parámetros está dada por
<span class="math display">\[\begin{equation}
\begin{pmatrix}
  \frac{n}{\sigma^2} &amp; 0 \\
  0 &amp; \frac{n}{2\sigma^4} \\
\end{pmatrix}
\end{equation}\]</span></p>
cuyo determinante está dado por <span class="math inline">\(\frac{n^2}{2\sigma^6}\)</span>. Por lo tanto, la distribución a previa no informativa de Jeffreys está dada por
<span class="math display">\[\begin{equation}
p(\theta,\sigma^2)\propto 1/\sigma^3
\end{equation}\]</span>
</div>
</div>
</div>
<p style="text-align: center;">
<a href="2-inferencia-bayesiana.html"><button class="btn btn-default">Previous</button></a>
<a href="2-2-pruebas-de-hipótesis.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
