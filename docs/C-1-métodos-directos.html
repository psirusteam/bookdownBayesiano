<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="C.1 Métodos directos | Modelos Bayesianos con R y STAN" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Este es el repositorio del libro Modelos Bayesianos con R y STAN." />
<meta name="github-repo" content="psirusteam/bookdownBayesiano" />

<meta name="author" content="Andrés Gutiérrez - Hanwen Zhang" />

<meta name="date" content="2021-06-04" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Este es el repositorio del libro Modelos Bayesianos con R y STAN.">

<title>C.1 Métodos directos | Modelos Bayesianos con R y STAN</title>

<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#prefacio">Prefacio</a></li>
<li><a href="antes-de-comenzar.html#antes-de-comenzar">Antes de comenzar</a>
<ul>
<li><a href="cuestionamientos-sobre-el-enfoque-bayesiano.html#cuestionamientos-sobre-el-enfoque-bayesiano">Cuestionamientos sobre el enfoque bayesiano</a></li>
<li><a href="acerca-de-la-notación.html#acerca-de-la-notación">Acerca de la notación</a></li>
</ul></li>
<li><a href="1-tópicos-básicos.html#tópicos-básicos"><span class="toc-section-number">1</span> Tópicos básicos</a>
<ul>
<li><a href="1-1-teoría-de-la-decisión.html#teoría-de-la-decisión"><span class="toc-section-number">1.1</span> Teoría de la decisión</a></li>
<li><a href="1-2-algunos-resultados-de-probabilidad.html#algunos-resultados-de-probabilidad"><span class="toc-section-number">1.2</span> Algunos resultados de probabilidad</a></li>
<li><a href="1-3-teorema-de-bayes.html#teorema-de-bayes"><span class="toc-section-number">1.3</span> Teorema de Bayes</a></li>
</ul></li>
<li><a href="2-inferencia-bayesiana.html#inferencia-bayesiana"><span class="toc-section-number">2</span> Inferencia bayesiana</a>
<ul>
<li><a href="2-1-la-distribución-previa.html#la-distribución-previa"><span class="toc-section-number">2.1</span> La distribución previa</a>
<ul>
<li><a href="2-1-la-distribución-previa.html#distribuciones-conjugadas"><span class="toc-section-number">2.1.1</span> Distribuciones conjugadas</a></li>
<li><a href="2-1-la-distribución-previa.html#familia-exponencial"><span class="toc-section-number">2.1.2</span> Familia exponencial</a></li>
<li><a href="2-1-la-distribución-previa.html#distribuciones-previas-no-informativas"><span class="toc-section-number">2.1.3</span> Distribuciones previas no informativas</a></li>
</ul></li>
<li><a href="2-2-pruebas-de-hipótesis.html#pruebas-de-hipótesis"><span class="toc-section-number">2.2</span> Pruebas de hipótesis</a>
<ul>
<li><a href="2-2-pruebas-de-hipótesis.html#factor-de-bayes"><span class="toc-section-number">2.2.1</span> Factor de Bayes</a></li>
<li><a href="2-2-pruebas-de-hipótesis.html#valor-p-bayesiano"><span class="toc-section-number">2.2.2</span> Valor-<span class="math inline">\(p\)</span> Bayesiano</a></li>
</ul></li>
<li><a href="2-3-criterios-de-información.html#criterios-de-información"><span class="toc-section-number">2.3</span> Criterios de información</a>
<ul>
<li><a href="2-3-criterios-de-información.html#criterio-dic"><span class="toc-section-number">2.3.1</span> Criterio DIC</a></li>
<li><a href="2-3-criterios-de-información.html#criterios-aic-y-bic"><span class="toc-section-number">2.3.2</span> Criterios AIC y BIC</a></li>
</ul></li>
</ul></li>
<li><a href="3-modelos-uniparamétricos.html#modelos-uniparamétricos"><span class="toc-section-number">3</span> Modelos uniparamétricos</a>
<ul>
<li><a href="3-1-modelo-bernoulli.html#modelo-bernoulli"><span class="toc-section-number">3.1</span> Modelo Bernoulli</a></li>
<li><a href="3-2-modelo-binomial.html#modelo-binomial"><span class="toc-section-number">3.2</span> Modelo Binomial</a></li>
</ul></li>
<li class="appendix"><span><b>Apéndice</b></span></li>
<li><a href="A-elementos-de-probabilidad.html#elementos-de-probabilidad"><span class="toc-section-number">A</span> Elementos de probabilidad</a>
<ul>
<li><a href="A-1-distribuciones-discretas.html#distribuciones-discretas"><span class="toc-section-number">A.1</span> Distribuciones discretas</a>
<ul>
<li><a href="A-1-distribuciones-discretas.html#distribución-uniforme-discreta"><span class="toc-section-number">A.1.1</span> Distribución uniforme discreta</a></li>
<li><a href="A-1-distribuciones-discretas.html#distribución-hipergeométrica"><span class="toc-section-number">A.1.2</span> Distribución hipergeométrica</a></li>
<li><a href="A-1-distribuciones-discretas.html#distribución-bernoulli"><span class="toc-section-number">A.1.3</span> Distribución Bernoulli</a></li>
<li><a href="A-1-distribuciones-discretas.html#distribución-binomial"><span class="toc-section-number">A.1.4</span> Distribución binomial</a></li>
<li><a href="A-1-distribuciones-discretas.html#distribución-binomial-negativa"><span class="toc-section-number">A.1.5</span> Distribución Binomial negativa</a></li>
<li><a href="A-1-distribuciones-discretas.html#distribución-de-poisson"><span class="toc-section-number">A.1.6</span> Distribución de Poisson</a></li>
</ul></li>
<li><a href="A-2-distribuciones-continuas.html#distribuciones-continuas"><span class="toc-section-number">A.2</span> Distribuciones continuas</a>
<ul>
<li><a href="A-2-distribuciones-continuas.html#distribución-uniforme-continua"><span class="toc-section-number">A.2.1</span> Distribución Uniforme Continua</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-weibull"><span class="toc-section-number">A.2.2</span> Distribución Weibull</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-valor-extremo"><span class="toc-section-number">A.2.3</span> Distribución valor-extremo</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-gamma"><span class="toc-section-number">A.2.4</span> Distribución Gamma</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-gamma-inversa"><span class="toc-section-number">A.2.5</span> Distribución Gamma-inversa</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-exponencial"><span class="toc-section-number">A.2.6</span> Distribución exponencial</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-beta"><span class="toc-section-number">A.2.7</span> Distribución Beta</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-normal"><span class="toc-section-number">A.2.8</span> Distribución normal</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-log-normal"><span class="toc-section-number">A.2.9</span> Distribución log-normal</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-ji-cuadrado"><span class="toc-section-number">A.2.10</span> Distribución Ji-cuadrado</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-t-student"><span class="toc-section-number">A.2.11</span> Distribución t-student</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-t-student-generalizada"><span class="toc-section-number">A.2.12</span> Distribución t-student generalizada</a></li>
<li><a href="A-2-distribuciones-continuas.html#distribución-f"><span class="toc-section-number">A.2.13</span> Distribución F</a></li>
</ul></li>
<li><a href="A-3-distribuciones-multivariadas.html#distribuciones-multivariadas"><span class="toc-section-number">A.3</span> Distribuciones multivariadas</a>
<ul>
<li><a href="A-3-distribuciones-multivariadas.html#distribución-multinomial"><span class="toc-section-number">A.3.1</span> Distribución Multinomial</a></li>
<li><a href="A-3-distribuciones-multivariadas.html#distribución-dirichelt"><span class="toc-section-number">A.3.2</span> Distribución Dirichelt</a></li>
<li><a href="A-3-distribuciones-multivariadas.html#distribución-normal-multivariante"><span class="toc-section-number">A.3.3</span> Distribución Normal Multivariante</a></li>
<li><a href="A-3-distribuciones-multivariadas.html#distribución-wishart"><span class="toc-section-number">A.3.4</span> Distribución Wishart</a></li>
<li><a href="A-3-distribuciones-multivariadas.html#distribución-inversa-wishart"><span class="toc-section-number">A.3.5</span> Distribución inversa-Wishart</a></li>
</ul></li>
</ul></li>
<li><a href="B-matriz-de-información.html#matriz-de-información"><span class="toc-section-number">B</span> Matriz de información</a></li>
<li><a href="C-elementos-de-simulación-estadística.html#elementos-de-simulación-estadística"><span class="toc-section-number">C</span> Elementos de simulación estadística</a>
<ul>
<li><a href="C-1-métodos-directos.html#métodos-directos"><span class="toc-section-number">C.1</span> Métodos directos</a>
<ul>
<li><a href="C-1-métodos-directos.html#método-de-la-transformación-uniforme"><span class="toc-section-number">C.1.1</span> Método de la transformación uniforme</a></li>
<li><a href="C-1-métodos-directos.html#método-de-la-grilla"><span class="toc-section-number">C.1.2</span> Método de la grilla</a></li>
</ul></li>
<li><a href="C-2-métodos-de-monte-carlo-vía-cadenas-de-markov.html#métodos-de-monte-carlo-vía-cadenas-de-markov"><span class="toc-section-number">C.2</span> Métodos de Monte Carlo vía cadenas de Markov</a>
<ul>
<li><a href="C-2-métodos-de-monte-carlo-vía-cadenas-de-markov.html#el-muestreador-de-gibbs"><span class="toc-section-number">C.2.1</span> El muestreador de Gibbs</a></li>
<li><a href="C-2-métodos-de-monte-carlo-vía-cadenas-de-markov.html#el-algoritmo-de-metrópolis-hastings"><span class="toc-section-number">C.2.2</span> El algoritmo de Metrópolis-Hastings</a></li>
<li><a href="C-2-métodos-de-monte-carlo-vía-cadenas-de-markov.html#buenas-prácticas-en-la-aplicación-de-métodos-mcmc"><span class="toc-section-number">C.2.3</span> Buenas prácticas en la aplicación de métodos MCMC</a></li>
</ul></li>
</ul></li>
<li><a href="referencias.html#referencias">Referencias</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="métodos-directos" class="section level2" number="6.1">
<h2><span class="header-section-number">C.1</span> Métodos directos</h2>
<div id="método-de-la-transformación-uniforme" class="section level3" number="6.1.1">
<h3><span class="header-section-number">C.1.1</span> Método de la transformación uniforme</h3>
<p>Al momento de la simulación estocástica de observaciones provenientes de alguna distribución de interés, la distribución uniforme es quizás la más usada y la más importante. El siguiente resultado adaptado de <span class="citation"><a href="#ref-Casella" role="doc-biblioref">Robert y Casella</a> (<a href="#ref-Casella" role="doc-biblioref">1999</a>)</span> así lo confirma.</p>

<div class="proposition">
<span id="prp:unnamed-chunk-1" class="proposition"><strong>Resultado 3.1  </strong></span>Si <span class="math inline">\(U\)</span> es una variable aleatoria con distribución uniforme en el intervalo <span class="math inline">\((0,1)\)</span>, entonces la la variable aleatoria <span class="math inline">\(F^{-1}(U)\)</span> tiene distribución F.
</div>
<p><br></p>
<p>Aunque la función <span class="math inline">\(F\)</span> no necesariamente es una función uno a uno (por lo menos no lo es en el caso discreto) sí se puede verificar que <span class="math inline">\(F^{-1}(U)\)</span> es única con probabilidad uno. Una definición general, que encaja en el caso continuo o discreto, de la función <span class="math inline">\(F\)</span> inversa es la siguiente</p>

<div class="definition">
<p><span id="def:unnamed-chunk-2" class="definition"><strong>Definición C.1  </strong></span>Para cualquier función <span class="math inline">\(F\)</span> definida sobre <span class="math inline">\(\mathbb{R}\)</span>, se define la función inversa generalizada de <span class="math inline">\(F\)</span> como</p>
<span class="math display">\[\begin{equation}
F^{-1}(u)=\inf \{x \mid F(x)\geq u\}
\end{equation}\]</span>
</div>

<div class="example">
<p><span id="exm:unnamed-chunk-3" class="example"><strong>Ejemplo 1.3  </strong></span>Suponga que <span class="math inline">\(X\)</span> es una variable aleatoria con distribución exponencial. De esta forma, su función de densidad acumulativa viene dada por</p>
<p><span class="math display">\[\begin{equation*}
F(x)=1-\exp\{ -\theta x\}
\end{equation*}\]</span></p>
<p>Del anterior resultado se tiene que si <span class="math inline">\(u\)</span> es una realización de una variable <span class="math inline">\(U \sim Uniforme(0,1)\)</span>, entonces <span class="math inline">\(F^{-1}(u)\)</span> es una realización de una variable con distribución exponencial. Como <span class="math inline">\(x=F^{-1}(u)\)</span>, entonces <span class="math inline">\(F(x)=u\)</span> y despejando <span class="math inline">\(x\)</span>, se llega a que la siguiente expresión</p>
<p><span class="math display">\[\begin{equation*}
F^{-1}(u)=-\frac{\ln(1-u)}{\theta}
\end{equation*}\]</span></p>
entrega una forma diáfana para la simulación de una observación con distribución exponencial. Para simular una muestra de <span class="math inline">\(n\)</span> observaciones, simplemente se repite el anterior procedimiento <span class="math inline">\(n\)</span> veces. En <code>R</code>, el código necesario para la simulación de una muestra de tamaño 1000 proveniente de una distribución exponencial con parámetro <span class="math inline">\(\theta=5\)</span> es
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="C-1-métodos-directos.html#cb34-1" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb34-2"><a href="C-1-métodos-directos.html#cb34-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb34-3"><a href="C-1-métodos-directos.html#cb34-3" aria-hidden="true" tabindex="-1"></a>rexpo <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u)<span class="sc">/</span>(<span class="sc">-</span>theta)</span>
<span id="cb34-4"><a href="C-1-métodos-directos.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(rexpo)</span></code></pre></div>
<pre><code>## [1] 5.073495</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="C-1-métodos-directos.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(rexpo, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-2"><a href="C-1-métodos-directos.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(rexpo), <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-4"></span>
<img src="A3Simulacion_files/figure-html/unnamed-chunk-4-1.png" alt="Histograma de observaciones con distribución exponencial" width="672" />
<p class="caption">
Figura C.1: Histograma de observaciones con distribución exponencial
</p>
</div>
</div>
<div id="método-de-la-grilla" class="section level3" number="6.1.2">
<h3><span class="header-section-number">C.1.2</span> Método de la grilla</h3>
<p>Existen distribuciones de probabilidad cuya forma estructural es muy compleja. Mas aún, existen distribuciones de probabilidad conocidas para las cuales la inversa de la función de de densidad acumulativa es difícil de solucionar analíticamente. En los anteriores casos, el método analítico dado por el teorema de la transformación integral de probabilidad no siempre resulta efectivo. Sin embargo, es posible realizar una variante, manteniendo el espíritu de la anterior técnica.</p>
<p>El presente método utiliza una distribución discreta para aproximar cualquier tipo de distribución (discreta o continua) sin importar su nivel de complejidad. El algoritmo que enmarca este método se da a continuación:</p>
<ol style="list-style-type: decimal">
<li>Escribir la densidad de interés como <span class="math inline">\(f(\cdot)\)</span> y establecer el rango de la variable aleatoria de interés.</li>
<li>Fijar un conjunto de <span class="math inline">\(n\)</span> valores <span class="math inline">\(x_1&lt;\cdots&lt;x_n\)</span> equiespaciados que cubran una gran parte del rango de la variable aleatoria.</li>
<li>Para <span class="math inline">\(x_k\)</span> <span class="math inline">\((k=1,\ldots,n)\)</span> calcular <span class="math inline">\(f(x_k)\)</span> que equivale al valor de la densidad en el punto <span class="math inline">\(x_k\)</span>. Nótese que si <span class="math inline">\(f(\cdot)\)</span> es una función de densidad continua, entonces <span class="math inline">\(f(x_k)\)</span> no corresponde a una probabilidad;</li>
<li>Calcular la probabilidad asociada al punto <span class="math inline">\(x_k\)</span> definida por la aproximación discreta a <span class="math inline">\(f(\cdot)\)</span> y dada por
<span class="math display">\[\begin{equation*}
p(x_k)=\frac{f(x_k)}{\sum_{k=1}^{n}f(x_k)}
\end{equation*}\]</span></li>
<li>Calcular la función de densidad acumulativa aproximada definida como
<span class="math display">\[\begin{equation*}
F(x)=
\begin{cases}
0, \ \ \ \text{si $x&lt;x_1$}\\
\sum_{l=1}^kp(x_l), \ \ \ \text{si $x_k\leq x&lt;x_{k+1}$}\\
1, \ \ \ \text{si $x&gt;x_n$}
\end{cases}
\end{equation*}\]</span></li>
<li>Simular una observación <span class="math inline">\(u\)</span> proveniente de una distribución uniforme continua en el intervalo <span class="math inline">\((0,1)\)</span>.</li>
<li>Si <span class="math inline">\(F(x_k)&lt;u\leq F(x_{k+1})\)</span>, entonces <span class="math inline">\(F^{-1}(u)=x_{k+1}\)</span> y por consiguiente el valor <span class="math inline">\(x_{k+1}\)</span> es una pseudo-observación proveniente de la densidad de interés.</li>
</ol>
<p>Nótese que en el anterior proceso, la unidad <span class="math inline">\(x_{k+1}\)</span> es seleccionada con probabilidad <span class="math inline">\(p_{k+1}\)</span>; puesto que</p>
<p><span class="math display">\[\begin{align*}
P(F(x_k)&lt; U \leq F(x_{k+1}))&amp;=F(x_{k+1})-F(x_{k})\\
&amp;=\sum_{l=1}^{k+1}p(x_l)-\sum_{l=1}^kp(x_l)=p_{k+1}
\end{align*}\]</span></p>
<p>Si se quiere extraer una muestra aleatoria de <span class="math inline">\(N\)</span> observaciones provenientes de la distribución de interés, entonces basta con repetir el anterior proceso <span class="math inline">\(N\)</span> veces. Por supuesto, como se trata de una muestra aleatoria cada selección se debe realizar con repetición; de esta manera no importa si <span class="math inline">\(N&gt;n\)</span>. Suponiendo que el conjunto <span class="math inline">\(x_1,\ldots,x_n\)</span> conforma una grilla de puntos lo suficientemente cercanos y que no sucede nada importante entre cada uno de ellos, entonces esta técnica debe tener un buen funcionamiento.</p>

<div class="example">
<span id="exm:unnamed-chunk-5" class="example"><strong>Ejemplo C.1  </strong></span>El siguiente código computacional permite utilizar el método de la grilla para simular mil valores provenientes de una distribución exponencial con parámetro <span class="math inline">\(\theta = 5\)</span>.
</div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="C-1-métodos-directos.html#cb37-1" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb37-2"><a href="C-1-métodos-directos.html#cb37-2" aria-hidden="true" tabindex="-1"></a>x.grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb37-3"><a href="C-1-métodos-directos.html#cb37-3" aria-hidden="true" tabindex="-1"></a>p.exp <span class="ot">&lt;-</span> theta <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>theta <span class="sc">*</span> x.grid)</span>
<span id="cb37-4"><a href="C-1-métodos-directos.html#cb37-4" aria-hidden="true" tabindex="-1"></a>r.exp <span class="ot">&lt;-</span> <span class="fu">sample</span>(x.grid, <span class="dv">1000</span>, <span class="at">prob =</span> p.exp, <span class="at">replace =</span> T)</span>
<span id="cb37-5"><a href="C-1-métodos-directos.html#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(r.exp)</span></code></pre></div>
<pre><code>## [1] 5.111429</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="C-1-métodos-directos.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(r.exp, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-2"><a href="C-1-métodos-directos.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(rexpo), <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-6"></span>
<img src="A3Simulacion_files/figure-html/unnamed-chunk-6-1.png" alt="Histograma de observaciones con distribución exponencial" width="672" />
<p class="caption">
Figura C.2: Histograma de observaciones con distribución exponencial
</p>
</div>

<div class="example">
<span id="exm:unnamed-chunk-7" class="example"><strong>Ejemplo C.2  </strong></span>De la misma manera, el método de la grilla permite simular valores de un distribución discreta. El siguiente código computacional permite utilizar el método de la grilla para simular mil valores provenientes de una distribución Poisson con parámetro <span class="math inline">\(\theta = 2\)</span>.
</div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="C-1-métodos-directos.html#cb40-1" aria-hidden="true" tabindex="-1"></a>p.poisson <span class="ot">&lt;-</span><span class="cf">function</span>(theta, x.grid){</span>
<span id="cb40-2"><a href="C-1-métodos-directos.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(x.grid)</span>
<span id="cb40-3"><a href="C-1-métodos-directos.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, N)</span>
<span id="cb40-4"><a href="C-1-métodos-directos.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb40-5"><a href="C-1-métodos-directos.html#cb40-5" aria-hidden="true" tabindex="-1"></a>    P1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>theta) <span class="sc">*</span> theta<span class="sc">^</span>(x.grid[k])</span>
<span id="cb40-6"><a href="C-1-métodos-directos.html#cb40-6" aria-hidden="true" tabindex="-1"></a>    P2 <span class="ot">&lt;-</span> <span class="fu">factorial</span>(x.grid[k])</span>
<span id="cb40-7"><a href="C-1-métodos-directos.html#cb40-7" aria-hidden="true" tabindex="-1"></a>    res[k] <span class="ot">&lt;-</span> P1<span class="sc">/</span>P2</span>
<span id="cb40-8"><a href="C-1-métodos-directos.html#cb40-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-9"><a href="C-1-métodos-directos.html#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb40-10"><a href="C-1-métodos-directos.html#cb40-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-11"><a href="C-1-métodos-directos.html#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="C-1-métodos-directos.html#cb40-12" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb40-13"><a href="C-1-métodos-directos.html#cb40-13" aria-hidden="true" tabindex="-1"></a>x.grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb40-14"><a href="C-1-métodos-directos.html#cb40-14" aria-hidden="true" tabindex="-1"></a>f.x <span class="ot">&lt;-</span> <span class="fu">p.poisson</span>(theta, x.grid)</span>
<span id="cb40-15"><a href="C-1-métodos-directos.html#cb40-15" aria-hidden="true" tabindex="-1"></a>p.x <span class="ot">&lt;-</span> f.x<span class="sc">/</span><span class="fu">sum</span>(f.x)</span>
<span id="cb40-16"><a href="C-1-métodos-directos.html#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(p.x)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="C-1-métodos-directos.html#cb42-1" aria-hidden="true" tabindex="-1"></a>rpois <span class="ot">&lt;-</span> <span class="fu">sample</span>(x.grid, <span class="dv">1000</span>, <span class="at">prob=</span>p.x, <span class="at">replace =</span> T)</span>
<span id="cb42-2"><a href="C-1-métodos-directos.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(rpois)</span></code></pre></div>
<pre><code>## [1] 2.012</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="C-1-métodos-directos.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(rpois)</span></code></pre></div>
<pre><code>## [1] 1.929786</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="C-1-métodos-directos.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(rpois, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-8"></span>
<img src="A3Simulacion_files/figure-html/unnamed-chunk-8-1.png" alt="Histograma de observaciones con distribución Poisson" width="672" />
<p class="caption">
Figura C.3: Histograma de observaciones con distribución Poisson
</p>
</div>

<div class="example">
<span id="exm:unnamed-chunk-9" class="example"><strong>Ejemplo B.2  </strong></span>El método de la grilla también puede utilizarse para simular observaciones de una distribución biparamétrica, univariada y continua. El siguiente código computacional permite utilizar el método de la grilla para simular mil valores provenientes de una distribución Gamma con parámetros <span class="math inline">\(\theta = 4\)</span>, <span class="math inline">\(\beta = 2\)</span>.
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="C-1-métodos-directos.html#cb47-1" aria-hidden="true" tabindex="-1"></a>p.gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, x.grid){</span>
<span id="cb47-2"><a href="C-1-métodos-directos.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span><span class="fu">length</span>(x.grid)</span>
<span id="cb47-3"><a href="C-1-métodos-directos.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, N)</span>
<span id="cb47-4"><a href="C-1-métodos-directos.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb47-5"><a href="C-1-métodos-directos.html#cb47-5" aria-hidden="true" tabindex="-1"></a>    P1 <span class="ot">&lt;-</span> (b<span class="sc">^</span>a)<span class="sc">/</span><span class="fu">gamma</span>(a)</span>
<span id="cb47-6"><a href="C-1-métodos-directos.html#cb47-6" aria-hidden="true" tabindex="-1"></a>    P2 <span class="ot">&lt;-</span> x.grid[k]<span class="sc">^</span>(a <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb47-7"><a href="C-1-métodos-directos.html#cb47-7" aria-hidden="true" tabindex="-1"></a>    P3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>b <span class="sc">*</span> x.grid[k])</span>
<span id="cb47-8"><a href="C-1-métodos-directos.html#cb47-8" aria-hidden="true" tabindex="-1"></a>    res[k] <span class="ot">&lt;-</span> P1<span class="sc">*</span>P2<span class="sc">*</span>P3</span>
<span id="cb47-9"><a href="C-1-métodos-directos.html#cb47-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-10"><a href="C-1-métodos-directos.html#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb47-11"><a href="C-1-métodos-directos.html#cb47-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-12"><a href="C-1-métodos-directos.html#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="C-1-métodos-directos.html#cb47-13" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb47-14"><a href="C-1-métodos-directos.html#cb47-14" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb47-15"><a href="C-1-métodos-directos.html#cb47-15" aria-hidden="true" tabindex="-1"></a>x.grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb47-16"><a href="C-1-métodos-directos.html#cb47-16" aria-hidden="true" tabindex="-1"></a>f.x <span class="ot">&lt;-</span> <span class="fu">p.gamma</span>(alpha, beta, x.grid)</span>
<span id="cb47-17"><a href="C-1-métodos-directos.html#cb47-17" aria-hidden="true" tabindex="-1"></a>p.x <span class="ot">&lt;-</span> f.x <span class="sc">/</span> <span class="fu">sum</span>(f.x)</span>
<span id="cb47-18"><a href="C-1-métodos-directos.html#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="C-1-métodos-directos.html#cb47-19" aria-hidden="true" tabindex="-1"></a>rgamma <span class="ot">&lt;-</span> <span class="fu">sample</span>(x.grid, <span class="dv">1000</span>, <span class="at">prob =</span> p.x, <span class="at">replace =</span> T)</span>
<span id="cb47-20"><a href="C-1-métodos-directos.html#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(rgamma)</span></code></pre></div>
<pre><code>## [1] 2.0266</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="C-1-métodos-directos.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(rgamma)</span></code></pre></div>
<pre><code>## [1] 1.045178</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="C-1-métodos-directos.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(rgamma, <span class="at">freq =</span> F)</span>
<span id="cb51-2"><a href="C-1-métodos-directos.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(rgamma), <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-10"></span>
<img src="A3Simulacion_files/figure-html/unnamed-chunk-10-1.png" alt="Histograma de observaciones con distribución Gamma." width="672" />
<p class="caption">
Figura C.4: Histograma de observaciones con distribución Gamma.
</p>
</div>

<div class="example">
<span id="exm:unnamed-chunk-11" class="example"><strong>Ejemplo 1.4  </strong></span>Para comprobar el poder de este método de simulación, se presenta el siguiente código que permite simular valores de una distribución multiparamétrica, bivariada y continua. En particular, se simulan valores de la distribución Normal multivariante con vector de medias <span class="math inline">\(\boldsymbol \mu= (2, 4)&#39;\)</span> y matriz de varianzas covarianzas
<span class="math inline">\(\boldsymbol \Sigma= \begin{bmatrix} 25 &amp; 30 \\ 30 &amp; 16 \end{bmatrix}\)</span>
</div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="C-1-métodos-directos.html#cb52-1" aria-hidden="true" tabindex="-1"></a>p.normal2 <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, Sigma, x, y){</span>
<span id="cb52-2"><a href="C-1-métodos-directos.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  P1  <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb52-3"><a href="C-1-métodos-directos.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  P2  <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">det</span>(Sigma))</span>
<span id="cb52-4"><a href="C-1-métodos-directos.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  P3a <span class="ot">&lt;-</span> <span class="fu">t</span>((<span class="fu">c</span>(x, y) <span class="sc">-</span> mu)) <span class="sc">%*%</span> <span class="fu">solve</span>(Sigma) <span class="sc">%*%</span> (<span class="fu">c</span>(x, y) <span class="sc">-</span> mu)</span>
<span id="cb52-5"><a href="C-1-métodos-directos.html#cb52-5" aria-hidden="true" tabindex="-1"></a>  P3  <span class="ot">&lt;-</span> <span class="fu">exp</span>((<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> P3a)</span>
<span id="cb52-6"><a href="C-1-métodos-directos.html#cb52-6" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> P1 <span class="sc">*</span> P2 <span class="sc">*</span> P3</span>
<span id="cb52-7"><a href="C-1-métodos-directos.html#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb52-8"><a href="C-1-métodos-directos.html#cb52-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-9"><a href="C-1-métodos-directos.html#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="C-1-métodos-directos.html#cb52-10" aria-hidden="true" tabindex="-1"></a>grilla <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b){</span>
<span id="cb52-11"><a href="C-1-métodos-directos.html#cb52-11" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a))</span>
<span id="cb52-12"><a href="C-1-métodos-directos.html#cb52-12" aria-hidden="true" tabindex="-1"></a>  unoA <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(A))</span>
<span id="cb52-13"><a href="C-1-métodos-directos.html#cb52-13" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(b))</span>
<span id="cb52-14"><a href="C-1-métodos-directos.html#cb52-14" aria-hidden="true" tabindex="-1"></a>  unoB <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(B))</span>
<span id="cb52-15"><a href="C-1-métodos-directos.html#cb52-15" aria-hidden="true" tabindex="-1"></a>  P1 <span class="ot">&lt;-</span> <span class="fu">kronecker</span>(A, unoB)</span>
<span id="cb52-16"><a href="C-1-métodos-directos.html#cb52-16" aria-hidden="true" tabindex="-1"></a>  P2 <span class="ot">&lt;-</span> <span class="fu">kronecker</span>(unoA, B)</span>
<span id="cb52-17"><a href="C-1-métodos-directos.html#cb52-17" aria-hidden="true" tabindex="-1"></a>  grid <span class="ot">&lt;-</span> <span class="fu">cbind</span>(a[P1], b[P2])</span>
<span id="cb52-18"><a href="C-1-métodos-directos.html#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(grid)</span>
<span id="cb52-19"><a href="C-1-métodos-directos.html#cb52-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-20"><a href="C-1-métodos-directos.html#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="C-1-métodos-directos.html#cb52-21" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb52-22"><a href="C-1-métodos-directos.html#cb52-22" aria-hidden="true" tabindex="-1"></a>Sigma1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">16</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb52-23"><a href="C-1-métodos-directos.html#cb52-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-24"><a href="C-1-métodos-directos.html#cb52-24" aria-hidden="true" tabindex="-1"></a>x.grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(mu1[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sqrt</span>(Sigma1[<span class="dv">1</span>, <span class="dv">1</span>]),</span>
<span id="cb52-25"><a href="C-1-métodos-directos.html#cb52-25" aria-hidden="true" tabindex="-1"></a>              mu1[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sqrt</span>(Sigma1[<span class="dv">1</span>, <span class="dv">1</span>]),</span>
<span id="cb52-26"><a href="C-1-métodos-directos.html#cb52-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb52-27"><a href="C-1-métodos-directos.html#cb52-27" aria-hidden="true" tabindex="-1"></a>y.grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(mu1[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sqrt</span>(Sigma1[<span class="dv">2</span>, <span class="dv">2</span>]),</span>
<span id="cb52-28"><a href="C-1-métodos-directos.html#cb52-28" aria-hidden="true" tabindex="-1"></a>              mu1[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sqrt</span>(Sigma1[<span class="dv">2</span>, <span class="dv">2</span>]),</span>
<span id="cb52-29"><a href="C-1-métodos-directos.html#cb52-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fl">0.5</span>)</span>
<span id="cb52-30"><a href="C-1-métodos-directos.html#cb52-30" aria-hidden="true" tabindex="-1"></a>xy.grid <span class="ot">&lt;-</span> <span class="fu">grilla</span>(x.grid, y.grid)</span>
<span id="cb52-31"><a href="C-1-métodos-directos.html#cb52-31" aria-hidden="true" tabindex="-1"></a>N.grid <span class="ot">&lt;-</span> <span class="fu">dim</span>(xy.grid)[<span class="dv">1</span>]</span>
<span id="cb52-32"><a href="C-1-métodos-directos.html#cb52-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-33"><a href="C-1-métodos-directos.html#cb52-33" aria-hidden="true" tabindex="-1"></a>f.xy <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, N.grid)</span>
<span id="cb52-34"><a href="C-1-métodos-directos.html#cb52-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N.grid){</span>
<span id="cb52-35"><a href="C-1-métodos-directos.html#cb52-35" aria-hidden="true" tabindex="-1"></a>  f.xy[j] <span class="ot">&lt;-</span> <span class="fu">p.normal2</span>(mu1, Sigma1, </span>
<span id="cb52-36"><a href="C-1-métodos-directos.html#cb52-36" aria-hidden="true" tabindex="-1"></a>                       xy.grid[j, <span class="dv">1</span>], </span>
<span id="cb52-37"><a href="C-1-métodos-directos.html#cb52-37" aria-hidden="true" tabindex="-1"></a>                       xy.grid[j, <span class="dv">2</span>])</span>
<span id="cb52-38"><a href="C-1-métodos-directos.html#cb52-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-39"><a href="C-1-métodos-directos.html#cb52-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-40"><a href="C-1-métodos-directos.html#cb52-40" aria-hidden="true" tabindex="-1"></a>p.xy <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(f.xy<span class="sc">/</span><span class="fu">sum</span>(f.xy))</span>
<span id="cb52-41"><a href="C-1-métodos-directos.html#cb52-41" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(p.xy)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="C-1-métodos-directos.html#cb54-1" aria-hidden="true" tabindex="-1"></a>rnormal2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(N.grid, <span class="dv">1000</span>, <span class="at">prob =</span> p.xy, <span class="at">replace =</span> T)</span>
<span id="cb54-2"><a href="C-1-métodos-directos.html#cb54-2" aria-hidden="true" tabindex="-1"></a>rxy.normal2 <span class="ot">&lt;-</span> xy.grid[rnormal2, ]</span>
<span id="cb54-3"><a href="C-1-métodos-directos.html#cb54-3" aria-hidden="true" tabindex="-1"></a>rx.normal <span class="ot">&lt;-</span> rxy.normal2[, <span class="dv">1</span>]</span>
<span id="cb54-4"><a href="C-1-métodos-directos.html#cb54-4" aria-hidden="true" tabindex="-1"></a>ry.normal <span class="ot">&lt;-</span> rxy.normal2[, <span class="dv">2</span>]</span>
<span id="cb54-5"><a href="C-1-métodos-directos.html#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="C-1-métodos-directos.html#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(rxy.normal2)</span></code></pre></div>
<pre><code>## [1] 2.0100 4.0955</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="C-1-métodos-directos.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(rxy.normal2)</span></code></pre></div>
<pre><code>##          [,1]     [,2]
## [1,] 25.23213 10.38343
## [2,] 10.38343 15.95759</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="C-1-métodos-directos.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(rx.normal, <span class="at">freq =</span> F)</span>
<span id="cb58-2"><a href="C-1-métodos-directos.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(rx.normal), <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-12-1"></span>
<img src="A3Simulacion_files/figure-html/unnamed-chunk-12-1.png" alt="Histogramas de observaciones con distribución Normal bivariada." width="672" />
<p class="caption">
Figura C.5: Histogramas de observaciones con distribución Normal bivariada.
</p>
</div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="C-1-métodos-directos.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ry.normal, <span class="at">freq =</span> F)</span>
<span id="cb59-2"><a href="C-1-métodos-directos.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(ry.normal), <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span id="fig:unnamed-chunk-12-2"></span>
<img src="A3Simulacion_files/figure-html/unnamed-chunk-12-2.png" alt="Histogramas de observaciones con distribución Normal bivariada." width="672" />
<p class="caption">
Figura C.6: Histogramas de observaciones con distribución Normal bivariada.
</p>
</div>
</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Casella" class="csl-entry">
Robert, C. P., y G. Casella. 1999. <em>Monte Carlo Statistical Methods</em>. Springer.
</div>
</div>
<p style="text-align: center;">
<a href="C-elementos-de-simulación-estadística.html"><button class="btn btn-default">Previous</button></a>
<a href="C-2-métodos-de-monte-carlo-vía-cadenas-de-markov.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
