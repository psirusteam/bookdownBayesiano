<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.1 Modelo Normal con media y varianza desconocida | Modelos Bayesianos con R y STAN</title>
  <meta name="description" content="Este es el repositorio del libro Modelos Bayesianos con R y STAN." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="4.1 Modelo Normal con media y varianza desconocida | Modelos Bayesianos con R y STAN" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este es el repositorio del libro Modelos Bayesianos con R y STAN." />
  <meta name="github-repo" content="psirusteam/bookdownBayesiano" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.1 Modelo Normal con media y varianza desconocida | Modelos Bayesianos con R y STAN" />
  
  <meta name="twitter:description" content="Este es el repositorio del libro Modelos Bayesianos con R y STAN." />
  

<meta name="author" content="Andrés Gutiérrez - Hanwen Zhang" />


<meta name="date" content="2021-06-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelos-multiparamétricos.html"/>
<link rel="next" href="elementos-de-probabilidad.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos Bayesianos con R y STAN</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="chapter" data-level="" data-path="antes-de-comenzar.html"><a href="antes-de-comenzar.html"><i class="fa fa-check"></i>Antes de comenzar</a>
<ul>
<li class="chapter" data-level="" data-path="cuestionamientos-sobre-el-enfoque-bayesiano.html"><a href="cuestionamientos-sobre-el-enfoque-bayesiano.html"><i class="fa fa-check"></i>Cuestionamientos sobre el enfoque bayesiano</a></li>
<li class="chapter" data-level="" data-path="acerca-de-la-notación.html"><a href="acerca-de-la-notación.html"><i class="fa fa-check"></i>Acerca de la notación</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="tópicos-básicos.html"><a href="tópicos-básicos.html"><i class="fa fa-check"></i><b>1</b> Tópicos básicos</a>
<ul>
<li class="chapter" data-level="1.1" data-path="teoría-de-la-decisión.html"><a href="teoría-de-la-decisión.html"><i class="fa fa-check"></i><b>1.1</b> Teoría de la decisión</a></li>
<li class="chapter" data-level="1.2" data-path="algunos-resultados-de-probabilidad.html"><a href="algunos-resultados-de-probabilidad.html"><i class="fa fa-check"></i><b>1.2</b> Algunos resultados de probabilidad</a></li>
<li class="chapter" data-level="1.3" data-path="teorema-de-bayes.html"><a href="teorema-de-bayes.html"><i class="fa fa-check"></i><b>1.3</b> Teorema de Bayes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="inferencia-bayesiana.html"><a href="inferencia-bayesiana.html"><i class="fa fa-check"></i><b>2</b> Inferencia bayesiana</a>
<ul>
<li class="chapter" data-level="2.1" data-path="la-distribución-previa.html"><a href="la-distribución-previa.html"><i class="fa fa-check"></i><b>2.1</b> La distribución previa</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="la-distribución-previa.html"><a href="la-distribución-previa.html#distribuciones-conjugadas"><i class="fa fa-check"></i><b>2.1.1</b> Distribuciones conjugadas</a></li>
<li class="chapter" data-level="2.1.2" data-path="la-distribución-previa.html"><a href="la-distribución-previa.html#familia-exponencial"><i class="fa fa-check"></i><b>2.1.2</b> Familia exponencial</a></li>
<li class="chapter" data-level="2.1.3" data-path="la-distribución-previa.html"><a href="la-distribución-previa.html#distribuciones-previas-no-informativas"><i class="fa fa-check"></i><b>2.1.3</b> Distribuciones previas no informativas</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html"><i class="fa fa-check"></i><b>2.2</b> Pruebas de hipótesis</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#factor-de-bayes"><i class="fa fa-check"></i><b>2.2.1</b> Factor de Bayes</a></li>
<li class="chapter" data-level="2.2.2" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#valor-p-bayesiano"><i class="fa fa-check"></i><b>2.2.2</b> Valor-<span class="math inline">\(p\)</span> Bayesiano</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="criterios-de-información.html"><a href="criterios-de-información.html"><i class="fa fa-check"></i><b>2.3</b> Criterios de información</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="criterios-de-información.html"><a href="criterios-de-información.html#criterio-dic"><i class="fa fa-check"></i><b>2.3.1</b> Criterio DIC</a></li>
<li class="chapter" data-level="2.3.2" data-path="criterios-de-información.html"><a href="criterios-de-información.html#criterios-aic-y-bic"><i class="fa fa-check"></i><b>2.3.2</b> Criterios AIC y BIC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelos-uniparamétricos.html"><a href="modelos-uniparamétricos.html"><i class="fa fa-check"></i><b>3</b> Modelos uniparamétricos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modelo-bernoulli.html"><a href="modelo-bernoulli.html"><i class="fa fa-check"></i><b>3.1</b> Modelo Bernoulli</a></li>
<li class="chapter" data-level="3.2" data-path="modelo-binomial.html"><a href="modelo-binomial.html"><i class="fa fa-check"></i><b>3.2</b> Modelo Binomial</a></li>
<li class="chapter" data-level="3.3" data-path="modelo-binomial-negativo.html"><a href="modelo-binomial-negativo.html"><i class="fa fa-check"></i><b>3.3</b> Modelo Binomial negativo</a></li>
<li class="chapter" data-level="3.4" data-path="modelo-poisson.html"><a href="modelo-poisson.html"><i class="fa fa-check"></i><b>3.4</b> Modelo Poisson</a></li>
<li class="chapter" data-level="3.5" data-path="modelo-exponencial.html"><a href="modelo-exponencial.html"><i class="fa fa-check"></i><b>3.5</b> Modelo Exponencial</a></li>
<li class="chapter" data-level="3.6" data-path="modelo-normal-con-media-desconocida.html"><a href="modelo-normal-con-media-desconocida.html"><i class="fa fa-check"></i><b>3.6</b> Modelo Normal con media desconocida</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="modelo-normal-con-media-desconocida.html"><a href="modelo-normal-con-media-desconocida.html#distribución-previa-no-informativa-para-theta"><i class="fa fa-check"></i><b>3.6.1</b> Distribución previa no informativa para <span class="math inline">\(\theta\)</span></a></li>
<li class="chapter" data-level="3.6.2" data-path="modelo-normal-con-media-desconocida.html"><a href="modelo-normal-con-media-desconocida.html#diferentes-formas-de-hallar-la-distribución-previa-para-theta"><i class="fa fa-check"></i><b>3.6.2</b> Diferentes formas de hallar la distribución previa para <span class="math inline">\(\theta\)</span></a></li>
<li class="chapter" data-level="3.6.3" data-path="modelo-normal-con-media-desconocida.html"><a href="modelo-normal-con-media-desconocida.html#distribuciones-predictivas"><i class="fa fa-check"></i><b>3.6.3</b> Distribuciones predictivas</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="modelo-normal-con-varianza-desconocida.html"><a href="modelo-normal-con-varianza-desconocida.html"><i class="fa fa-check"></i><b>3.7</b> Modelo normal con varianza desconocida</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelos-multiparamétricos.html"><a href="modelos-multiparamétricos.html"><i class="fa fa-check"></i><b>4</b> Modelos multiparamétricos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelo-normal-con-media-y-varianza-desconocida.html"><a href="modelo-normal-con-media-y-varianza-desconocida.html"><i class="fa fa-check"></i><b>4.1</b> Modelo Normal con media y varianza desconocida</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="modelo-normal-con-media-y-varianza-desconocida.html"><a href="modelo-normal-con-media-y-varianza-desconocida.html#parámetros-independientes"><i class="fa fa-check"></i><b>4.1.1</b> Parámetros independientes</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Apéndice</b></span></li>
<li class="chapter" data-level="A" data-path="elementos-de-probabilidad.html"><a href="elementos-de-probabilidad.html"><i class="fa fa-check"></i><b>A</b> Elementos de probabilidad</a>
<ul>
<li class="chapter" data-level="A.1" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html"><i class="fa fa-check"></i><b>A.1</b> Distribuciones discretas</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-uniforme-discreta"><i class="fa fa-check"></i><b>A.1.1</b> Distribución uniforme discreta</a></li>
<li class="chapter" data-level="A.1.2" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-hipergeométrica"><i class="fa fa-check"></i><b>A.1.2</b> Distribución hipergeométrica</a></li>
<li class="chapter" data-level="A.1.3" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-bernoulli"><i class="fa fa-check"></i><b>A.1.3</b> Distribución Bernoulli</a></li>
<li class="chapter" data-level="A.1.4" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-binomial"><i class="fa fa-check"></i><b>A.1.4</b> Distribución binomial</a></li>
<li class="chapter" data-level="A.1.5" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-binomial-negativa"><i class="fa fa-check"></i><b>A.1.5</b> Distribución Binomial negativa</a></li>
<li class="chapter" data-level="A.1.6" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-de-poisson"><i class="fa fa-check"></i><b>A.1.6</b> Distribución de Poisson</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html"><i class="fa fa-check"></i><b>A.2</b> Distribuciones continuas</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-uniforme-continua"><i class="fa fa-check"></i><b>A.2.1</b> Distribución Uniforme Continua</a></li>
<li class="chapter" data-level="A.2.2" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-weibull"><i class="fa fa-check"></i><b>A.2.2</b> Distribución Weibull</a></li>
<li class="chapter" data-level="A.2.3" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-valor-extremo"><i class="fa fa-check"></i><b>A.2.3</b> Distribución valor-extremo</a></li>
<li class="chapter" data-level="A.2.4" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-gamma"><i class="fa fa-check"></i><b>A.2.4</b> Distribución Gamma</a></li>
<li class="chapter" data-level="A.2.5" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-gamma-inversa"><i class="fa fa-check"></i><b>A.2.5</b> Distribución Gamma-inversa</a></li>
<li class="chapter" data-level="A.2.6" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-exponencial"><i class="fa fa-check"></i><b>A.2.6</b> Distribución exponencial</a></li>
<li class="chapter" data-level="A.2.7" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-beta"><i class="fa fa-check"></i><b>A.2.7</b> Distribución Beta</a></li>
<li class="chapter" data-level="A.2.8" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-normal"><i class="fa fa-check"></i><b>A.2.8</b> Distribución normal</a></li>
<li class="chapter" data-level="A.2.9" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-log-normal"><i class="fa fa-check"></i><b>A.2.9</b> Distribución log-normal</a></li>
<li class="chapter" data-level="A.2.10" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-ji-cuadrado"><i class="fa fa-check"></i><b>A.2.10</b> Distribución Ji-cuadrado</a></li>
<li class="chapter" data-level="A.2.11" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-t-student"><i class="fa fa-check"></i><b>A.2.11</b> Distribución t-student</a></li>
<li class="chapter" data-level="A.2.12" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-t-student-generalizada"><i class="fa fa-check"></i><b>A.2.12</b> Distribución t-student generalizada</a></li>
<li class="chapter" data-level="A.2.13" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-f"><i class="fa fa-check"></i><b>A.2.13</b> Distribución F</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>A.3</b> Distribuciones multivariadas</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#distribución-multinomial"><i class="fa fa-check"></i><b>A.3.1</b> Distribución Multinomial</a></li>
<li class="chapter" data-level="A.3.2" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#distribución-dirichelt"><i class="fa fa-check"></i><b>A.3.2</b> Distribución Dirichelt</a></li>
<li class="chapter" data-level="A.3.3" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#distribución-normal-multivariante"><i class="fa fa-check"></i><b>A.3.3</b> Distribución Normal Multivariante</a></li>
<li class="chapter" data-level="A.3.4" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#distribución-wishart"><i class="fa fa-check"></i><b>A.3.4</b> Distribución Wishart</a></li>
<li class="chapter" data-level="A.3.5" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#distribución-inversa-wishart"><i class="fa fa-check"></i><b>A.3.5</b> Distribución inversa-Wishart</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="matriz-de-información.html"><a href="matriz-de-información.html"><i class="fa fa-check"></i><b>B</b> Matriz de información</a></li>
<li class="chapter" data-level="C" data-path="elementos-de-simulación-estadística.html"><a href="elementos-de-simulación-estadística.html"><i class="fa fa-check"></i><b>C</b> Elementos de simulación estadística</a>
<ul>
<li class="chapter" data-level="C.1" data-path="métodos-directos.html"><a href="métodos-directos.html"><i class="fa fa-check"></i><b>C.1</b> Métodos directos</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="métodos-directos.html"><a href="métodos-directos.html#método-de-la-transformación-uniforme"><i class="fa fa-check"></i><b>C.1.1</b> Método de la transformación uniforme</a></li>
<li class="chapter" data-level="C.1.2" data-path="métodos-directos.html"><a href="métodos-directos.html#método-de-la-grilla"><i class="fa fa-check"></i><b>C.1.2</b> Método de la grilla</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="métodos-de-monte-carlo-vía-cadenas-de-markov.html"><a href="métodos-de-monte-carlo-vía-cadenas-de-markov.html"><i class="fa fa-check"></i><b>C.2</b> Métodos de Monte Carlo vía cadenas de Markov</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="métodos-de-monte-carlo-vía-cadenas-de-markov.html"><a href="métodos-de-monte-carlo-vía-cadenas-de-markov.html#el-muestreador-de-gibbs"><i class="fa fa-check"></i><b>C.2.1</b> El muestreador de Gibbs</a></li>
<li class="chapter" data-level="C.2.2" data-path="métodos-de-monte-carlo-vía-cadenas-de-markov.html"><a href="métodos-de-monte-carlo-vía-cadenas-de-markov.html#el-algoritmo-de-metrópolis-hastings"><i class="fa fa-check"></i><b>C.2.2</b> El algoritmo de Metrópolis-Hastings</a></li>
<li class="chapter" data-level="C.2.3" data-path="métodos-de-monte-carlo-vía-cadenas-de-markov.html"><a href="métodos-de-monte-carlo-vía-cadenas-de-markov.html#buenas-prácticas-en-la-aplicación-de-métodos-mcmc"><i class="fa fa-check"></i><b>C.2.3</b> Buenas prácticas en la aplicación de métodos MCMC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a Modelos Bayesianos con R y STAN</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos Bayesianos con R y STAN</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelo-normal-con-media-y-varianza-desconocida" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Modelo Normal con media y varianza desconocida</h2>
<p>Supongamos que se dispone de realizaciones de un conjunto de variables independientes e idénticamente distribuidas <span class="math inline">\(Y_1,\cdots,Y_n\sim N(\theta,\sigma^2)\)</span>. Cuando se desconoce tanto la media como la varianza de la distribución es necesario plantear diversos enfoques y situarse en el más conveniente, según el contexto del problema. En términos de la asignación de las distribuciones previas para <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\sigma^2\)</span> es posible:</p>
<ul>
<li>Suponer que la distribución previa <span class="math inline">\(p(\theta)\)</span> es independiente de la distribución previa <span class="math inline">\(p(\sigma^2)\)</span> y que ambas distribuciones son informativas.</li>
<li>Suponer que la distribución previa <span class="math inline">\(p(\theta)\)</span> es independiente de la distribución previa <span class="math inline">\(p(\sigma^2)\)</span> y que ambas distribuciones son no informativas.</li>
<li>Suponer que la distribución previa para <span class="math inline">\(\theta\)</span> depende de <span class="math inline">\(\sigma^2\)</span> y escribirla como <span class="math inline">\(p(\theta \mid \sigma^2)\)</span>, mientras que la distribución previa de <span class="math inline">\(\sigma^2\)</span> no depende de <span class="math inline">\(\theta\)</span> y se puede escribir como <span class="math inline">\(p(\sigma^2)\)</span>.</li>
</ul>
<p>A continuación, analizamos cada uno de estos planteamientos, y desarrollamos los resultados necesarios para la estimación de <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\sigma^2\)</span>.</p>
<div id="parámetros-independientes" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Parámetros independientes</h3>
<p>El primer enfoque que consideraremos para el análisis de los parámetros de interés <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\sigma^2\)</span> en una distribución normal univariada es aquel que supone que las distribuciones previas de cada uno de ellos son independientes, pero al mismo tiempo informativas.  afirma que este supuesto de independencia es atractivo en problemas para los cuales la información previa para <span class="math inline">\(\theta\)</span> no toma la forma de un número fijo de observaciones con varianza <span class="math inline">\(\sigma^2\)</span>. Adicionalmente, este supuesto de independencia es coherente con el hecho de que en la teoría clásica de estimación los estimadores insesgados de varianza mínima de <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\sigma^2\)</span> son independientes <span class="citation">(<a href="#ref-Zhang" role="doc-biblioref">Zhang y Gutiérrez 2010</a>, Sección 2.4)</span></p>
<p>En este orden de ideas, y siguiendo la argumentación del capítulo anterior, la distribución previa para el parámetro <span class="math inline">\(\theta\)</span> será</p>
<p><span class="math display">\[\begin{equation*}
\theta \sim Normal(\mu,\tau^2)
\end{equation*}\]</span></p>
<p>Y la distribución previa para el parámetro <span class="math inline">\(\sigma^2\)</span> será
<span class="math display">\[\begin{equation*}
\sigma^2 \sim Inversa-Gamma(n_0/2,n_0\sigma^2_0/2)
\end{equation*}\]</span></p>
<p>Asumiendo independencia previa, la distribución previa conjunta estará dada por</p>
<p><span class="math display">\[\begin{equation}
p(\theta,\sigma^2)\propto (\sigma^2)^{-n_0/2-1}\exp\left\{-\dfrac{n_0\sigma^2_0}{2\sigma^2}\right\}
\exp\left\{-\frac{1}{2\tau^2}(\theta-\mu)^2\right\}
\end{equation}\]</span></p>
<p>Una vez que se conoce la forma estructural de la distribución previa conjunta, es posible establecer la distribución posterior conjunta puesto que la verosimilitud de los datos, <span class="math inline">\(p(\mathbf{Y} \mid \theta,\sigma^2)\)</span>, está dada por la expresión <a href="modelo-normal-con-media-desconocida.html#eq:veronormal">(3.16)</a> y</p>
<p><span class="math display">\[\begin{equation*}
p(\theta,\sigma^2 \mid \mathbf{Y})\propto p(\mathbf{Y} \mid \theta,\sigma^2)p(\theta,\sigma^2)
\end{equation*}\]</span></p>

<div class="proposition">
<p><span id="prp:unnamed-chunk-1" class="proposition"><strong>Resultado 3.1  </strong></span>La distribución posterior conjunta de los parámetros de interés está dada por</p>
<span class="math display">\[\begin{align}
p(\theta,\sigma^2 \mid \mathbf{Y})&amp;\propto (\sigma^2)^{-(n+n_0)/2-1} \notag \\
&amp;\times
\exp\left\{-\frac{1}{2\sigma^2}\left[n_0\sigma^2_0+(n-1)S^2+n(\bar{y}-\theta)^2\right]-\frac{1}{2\tau^2}(\theta-\mu)^2\right\}
\end{align}\]</span>
</div>
<p><br></p>

<div class="proof">
 <span class="proof"><em>Prueba. </em></span> Tenemos que
<span class="math display">\[\begin{align*}
p(\theta,\sigma^2 \mid \mathbf{Y})&amp;\propto p(\mathbf{Y} \mid \theta,\sigma^2)p(\theta,\sigma^2)\\
&amp;\propto(\sigma^2)^{-n/2}\exp\left\{-\frac{1}{2\sigma^2}\sum_{i=1}^n(y_i-\theta)^2\right\}(\sigma^2)^{-n_0/2-1}\exp\left\{-\dfrac{n_0\sigma^2_0}{2\sigma^2}\right\}
\exp\left\{-\frac{1}{2\tau^2}(\theta-\mu)^2\right\} \\
&amp;=(\sigma^2)^{-(n+n_0)/2-1}\exp\left\{-\frac{1}{2\sigma^2}\left[n_0\sigma^2_0+\sum_{i=1}^n(y_i-\theta)^2\right]-\frac{1}{2\tau^2}(\theta-\mu)^2\right\}\\
&amp;\propto (\sigma^2)^{-(n+n_0)/2-1}\exp\left\{-\frac{1}{2\sigma^2}\left[n_0\sigma^2_0+(n-1)S^2+n(\bar{y}-\theta)^2\right]-\frac{1}{2\tau^2}(\theta-\mu)^2\right\}
\end{align*}\]</span>
donde la última expresión se obtiene al sumar y restar <span class="math inline">\(\bar{y}\)</span> dentro de <span class="math inline">\((y_i-\theta)^2\)</span>.
</div>
<p><br></p>
<p>Nótese que la distribución posterior conjunta no tiene una forma estructural conocida y por lo tanto no es posible realizar el método de integración analítica para obtener una constante de integración <span class="citation">(<a href="#ref-Migon" role="doc-biblioref">Migon y Gamerman 1999</a>)</span>. Sin embargo, sí es posible obtener las distribuciones condicionales posteriores de <span class="math inline">\(\theta\)</span> y de <span class="math inline">\(\sigma^2\)</span>, notando que</p>
<p><span class="math display">\[\begin{align*}
p(\theta \mid \sigma^2,\mathbf{Y})\propto p(\theta,\underbrace{\sigma^2}_{fijo} \mid \mathbf{Y})
\ \ \ \ \ \ \ \ \ \text{y} \ \ \ \ \ \ \ \ \ \
p(\sigma^2 \mid \theta,\mathbf{Y})\propto p(\underbrace{\theta}_{fijo},\sigma^2 \mid \mathbf{Y})
\end{align*}\]</span></p>
<p>Es decir, para encontrar la distribución posterior condicional de <span class="math inline">\(\theta | \sigma^2\)</span>, se utiliza la distribución posterior conjunta y los términos que no dependan de <span class="math inline">\(\theta\)</span> se incorporan en la constante de proporcionalidad. El mismo razonamiento se aplica para encontrar la distribución posterior condicional de <span class="math inline">\(\sigma^2 | \theta\)</span>.</p>

<div class="proposition">
<p><span id="prp:unnamed-chunk-3" class="proposition"><strong>Resultado 2.2  </strong></span>La distribución posterior condicional de <span class="math inline">\(\theta\)</span> es</p>
<p><span class="math display" id="eq:PostThetaGibbs">\[\begin{equation}
\tag{4.1}
\theta  \mid  \sigma^2,\mathbf{Y} \sim Normal(\mu_n,\tau_n^2)
\end{equation}\]</span></p>
<p>En donde las expresiones para <span class="math inline">\(\mu_n\)</span> y <span class="math inline">\(\tau_n^2\)</span> están dadas por <a href="modelo-normal-con-media-desconocida.html#eq:TauSigman">(3.17)</a>. Por otro lado, la distribución posterior condicional de <span class="math inline">\(\sigma^2\)</span> es</p>
<p><span class="math display" id="eq:PostSigma2Gibbs">\[\begin{equation}
\tag{4.2}
\sigma^2  \mid  \theta,\mathbf{Y} \sim Inversa-Gamma\left(\dfrac{n_0+n}{2},\dfrac{v_0}{2}\right)
\end{equation}\]</span></p>
con <span class="math inline">\(v_0=n_0\sigma^2_0+(n-1)S^2+n(\bar{y}-\theta)^2\)</span>.
</div>
<p><br></p>

<div class="proof">
<p> <span class="proof"><em>Prueba. </em></span> Acudiendo a la distribución posterior conjunta, e incorporando los términos que no dependen de <span class="math inline">\(\theta\)</span> en la constante de proporcionalidad, se tiene que</p>
<p><span class="math display">\[\begin{align*}
p(\theta \mid \sigma^2,\mathbf{Y})&amp;\propto \exp\left\{-\frac{n}{2\sigma^2}(\bar{y}-\theta)^2-\frac{1}{2\tau^2}(\theta-\mu)^2\right\}
\end{align*}\]</span></p>
Completando los cuadrados se encuentra una expresión idéntica a la función de distribución de una variable aleatoria con distribución <span class="math inline">\(Normal(\mu_n, \tau^2_n)\)</span>. Similarmente, después de un desarrollo algebraico breve, se tiene la distribución posterior condicional de <span class="math inline">\(\sigma^2\)</span>.
</div>
<p><br></p>
<p>Una vez encontradas las distribuciones posteriores condicionales de <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\sigma^2\)</span>, es posible obtener la estimación puntual de estos parámetros usando métodos de Montecarlo, específicamente el muestreo de Gibbs que, en el contexto de este capítulo, se resume en los siguientes pasos:</p>
<ol style="list-style-type: decimal">
<li>Fijar un valor inicial para <span class="math inline">\(\theta\)</span>, denotado por <span class="math inline">\(\theta_{(1)}\)</span>.</li>
<li>Simular un valor de la distribución de <span class="math inline">\(\sigma^2|\theta,\mathbf{Y}\)</span> en <a href="modelo-normal-con-media-y-varianza-desconocida.html#eq:PostSigma2Gibbs">(4.2)</a>. Nótese que el parámetro <span class="math inline">\(v_0\)</span>, que depende de <span class="math inline">\(\theta\)</span>, debe ser reemplazado por <span class="math inline">\(\theta_{(1)}\)</span> del paso anterior. Este valor simulado se denotará como <span class="math inline">\(\sigma^2_{(1)}\)</span>.</li>
<li>Simular un valor de la distribución de <span class="math inline">\(\theta|\sigma^2,\mathbf{Y}\)</span> en <a href="modelo-normal-con-media-y-varianza-desconocida.html#eq:PostThetaGibbs">(4.1)</a>. Nótese que en <span class="math inline">\(\mu_n\)</span> y <span class="math inline">\(\tau^2_n\)</span> se debe reemplazar <span class="math inline">\(\sigma^2\)</span> por <span class="math inline">\(\sigma^2_{(1)}\)</span>. Este valor simulado se denotará como <span class="math inline">\(\theta_{(2)}\)</span>.</li>
<li>Repetir los pasos (2) y (3) hasta completar un número de iteraciones suficientes para alcanzar la convergencia en ambos parámetros.</li>
</ol>
<p>Después de ejecutar el muestreo de Gibbs, se eliminan los primeros valores simulados para descartar la influencia del valor inicial; además, posiblemente se deba efectuar la fase de <em>thinning</em> para eliminar las correlaciones que pueden estar presentes en las cadenas generadas. Posteriormente, se obtendrán los valores finales simulados de las distribuciones de <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\sigma^2\)</span>, con los cuales se podrá calcular las estimaciones respectivas, además de estimar los intervalos de credibilidad resultantes con los percentiles muestrales de los valores simulados.</p>
<p>En cuanto a la distribución predictiva para una nueva observación <span class="math inline">\(\tilde{y}\)</span>, esta está dada por la siguiente expresión
<span class="math display">\[\begin{equation*}
p(\tilde{y}\mid\mathbf{Y})=\int_0^\infty\int_{-\infty}^\infty p(\tilde{y}\mid\theta,\ \sigma^2)p(\theta,\ \sigma^2\mid\mathbf{Y})d\theta\ d\sigma^2
\end{equation*}\]</span></p>
<p>Hallar esta distribución de forma exacta no es fácil, y podemos optar por conocer el comportamiento probabilístico de <span class="math inline">\(\tilde{y}\)</span> por medio de la simulación estadística. Tal como se explicó en el capítulo anterior, se debe simular en primer lugar valores de <span class="math inline">\(\theta\)</span> y de <span class="math inline">\(\sigma^2\)</span> de la distribución posterior <span class="math inline">\(p(\theta,\ \sigma^2\mid\mathbf{Y})\)</span> - usando el muestreo de Gibbs - y posteriormente, valores de <span class="math inline">\(\tilde{y}\)</span> de la distribución <span class="math inline">\(p(\tilde{y}\mid\theta,\ \sigma^2)\)</span>.</p>
<p>Por otro lado, si se quiere conocer el comportamiento de una nueva muestra aleatoria <span class="math inline">\(Y_1^{*},\cdots,Y_{n^*}^{*}\)</span>, es posible hacerlo por medio de la distribución predictiva de la media <span class="math inline">\(\bar{Y}^*\)</span>, simulando en primer lugar valores de <span class="math inline">\(\theta\)</span> y de <span class="math inline">\(\sigma^2\)</span> de la distribución posterior <span class="math inline">\(p(\theta,\ \sigma^2\mid\mathbf{Y})\)</span> - usando el muestreo de Gibbs - y posteriormente valores de <span class="math inline">\(\bar{Y}^*\)</span> de la distribución <span class="math inline">\(N(\theta,\frac{\sigma^2}{n^*})\)</span>.</p>

<div class="example">
<p><span id="exm:EjeRenal" class="example"><strong>Ejemplo 4.1  </strong></span><span class="citation"><a href="#ref-Efronims" role="doc-biblioref">Efron</a> (<a href="#ref-Efronims" role="doc-biblioref">2010</a>)</span> consideró un conjunto de datos que muestran la función renal de 157 individuos que se sometieron a una prueba médica exhaustiva en un hospital. Los resultados de la prueba renal están en un intervalo de -6 puntos a 4 puntos. Entre más alto sea el resultado, se concluye que el riñón del individuo es más sano. Nótese que estas pruebas son importantes para predecir el comportamiento de un riñón donado a un paciente con problemas renales.</p>
<p>En principio, es de interés para el investigador conocer la media y la dispersión de estos datos, para poder analizar a fondo la situación de los pacientes que esperan un transplante. Dado que se trata de una primera aproximación, se prefiere utilizar distribuciones previas no informativas para los parámetros de la media y varianza. Lo anterior se logra en <code>STAN</code> definiendo las distribuciones previas de <code>theta ~ normal(0, 10000)</code> y de <code>sigma2 ~ inv_gamma(0.001, 0.001)</code>. De esta forma, la distribución previa de <span class="math inline">\(\theta\)</span> está centrada en cero, pero con una varianza muy grande al igual que la distribución de la varianza, los cuales representan distribuciones previas no informativas.</p>
El siguiente código en <code>STAN</code> muestra cómo se lleva a cabo la inferencia.
</div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-1" aria-hidden="true" tabindex="-1"></a>NormalMeanVar <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb78-2"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb78-3"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; n;</span></span>
<span id="cb78-4"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="st">  real y[n];</span></span>
<span id="cb78-5"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb78-6"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb78-7"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="st">  real sigma;</span></span>
<span id="cb78-8"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="st">  real theta;</span></span>
<span id="cb78-9"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb78-10"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb78-11"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="st">  real sigma2;</span></span>
<span id="cb78-12"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma2 = pow(sigma, 2);</span></span>
<span id="cb78-13"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb78-14"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb78-15"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="st">  y ~ normal(theta, sigma);</span></span>
<span id="cb78-16"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="st">  theta ~ normal(0, 1000);</span></span>
<span id="cb78-17"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma2 ~ inv_gamma(0.001, 0.001);</span></span>
<span id="cb78-18"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb78-19"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb78-20"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-21"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-21" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fl">1.69045085</span>, <span class="sc">-</span><span class="fl">1.41076082</span>, <span class="sc">-</span><span class="fl">0.27909483</span>, </span>
<span id="cb78-22"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-22" aria-hidden="true" tabindex="-1"></a>       <span class="sc">-</span><span class="fl">0.91387987</span>,  <span class="fl">3.21868429</span>, <span class="sc">-</span><span class="fl">1.47282460</span>, </span>
<span id="cb78-23"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-23" aria-hidden="true" tabindex="-1"></a>       <span class="sc">-</span><span class="fl">0.96524353</span>, <span class="sc">-</span><span class="fl">2.45084934</span>,  <span class="fl">1.03838153</span>, </span>
<span id="cb78-24"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-24" aria-hidden="true" tabindex="-1"></a>        <span class="fl">1.79928679</span>,  <span class="fl">0.97826621</span>,  <span class="fl">0.67463830</span>, </span>
<span id="cb78-25"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-25" aria-hidden="true" tabindex="-1"></a>       <span class="sc">-</span><span class="fl">1.08665864</span>, <span class="sc">-</span><span class="fl">0.00509027</span>,  <span class="fl">0.43708128</span>)</span>
<span id="cb78-26"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-26" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb78-27"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-28"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-28" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">y =</span> y,</span>
<span id="cb78-29"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n =</span> n)</span>
<span id="cb78-30"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-30" aria-hidden="true" tabindex="-1"></a>NormalMVfit <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">model_code =</span> NormalMeanVar,</span>
<span id="cb78-31"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb78-31" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> sample_data, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(NormalMVfit, <span class="at">digits =</span> <span class="dv">4</span>, </span>
<span id="cb79-2"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb79-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;sigma2&quot;</span>), <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>## Inference for Stan model: de363179728705eed697c67cf38b3332.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##          mean se_mean     sd    2.5%  97.5% n_eff   Rhat
## theta  0.0773  0.0089 0.4111 -0.7173 0.8999  2137 1.0004
## sigma  1.5517  0.0083 0.3157  1.0826 2.3188  1441 1.0021
## sigma2 2.5073  0.0321 1.1161  1.1721 5.3768  1208 1.0025
## 
## Samples were drawn using NUTS(diag_e) at Mon Jun 14 23:55:14 2021.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<p>Después de ejecutar las iteraciones necesarias, la salida del anterior código muestra una estimación puntual para la esperanza de <span class="math inline">\(Y\)</span> de 0.09 con un intervalo de credibilidad del 95% dado por (-0.71, 0.91). Por otro lado, la estimación puntual de la desviación estándar de <span class="math inline">\(Y\)</span> es de 1.55 con un intervalo de credibilidad del 95% dado por (1.09, 2.31).</p>
<p>Las figuras <a href="modelo-normal-con-media-y-varianza-desconocida.html#fig:posNormalMVStan2">4.1</a> muestra la distribución posterior para este ejemplo, junto con la estimación puntual, correspondiente a la desviación estándar.</p>
<div class="figure" style="text-align: center"><span id="fig:posNormalMVStan2"></span>
<img src="4Multiparametricos_files/figure-html/posNormalMVStan2-1.svg" alt="Distribuciones posteriores." width="576" />
<p class="caption">
Figura 4.1: Distribuciones posteriores.
</p>
</div>
<p>A continuación se ilustra el uso de <code>R</code> en la programación de un algoritmo de Gibbs para los datos del ejemplo anterior. Se recalca que se utiliza la librería <code>MCMCpack</code> <span class="citation">(<a href="#ref-MCMCpack" role="doc-biblioref">Martin, Quinn, y Park 2011</a>)</span> para generar las realizaciones de la distribución Inversa-Gamma.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MCMCpack)</span>
<span id="cb81-2"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co">#parametros previos de theta</span></span>
<span id="cb81-4"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-5"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-5" aria-hidden="true" tabindex="-1"></a>tau2 <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb81-6"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="co">#parametros previos de sigma2</span></span>
<span id="cb81-7"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb81-8"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-8" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">0.001</span></span>
<span id="cb81-9"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-10"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-10" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb81-11"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-11" aria-hidden="true" tabindex="-1"></a>theta.pos <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nsim)</span>
<span id="cb81-12"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-12" aria-hidden="true" tabindex="-1"></a>sigma2.pos <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nsim)</span>
<span id="cb81-13"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-14"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Valor inicial de theta</span></span>
<span id="cb81-15"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-15" aria-hidden="true" tabindex="-1"></a>theta.pos[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-16"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-17"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="co">#parametros posteriores de sigma2   </span></span>
<span id="cb81-18"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-18" aria-hidden="true" tabindex="-1"></a>a.n <span class="ot">&lt;-</span> a <span class="sc">+</span> n<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb81-19"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-19" aria-hidden="true" tabindex="-1"></a>b.n <span class="ot">&lt;-</span> b <span class="sc">+</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">var</span>(y) <span class="sc">+</span> n <span class="sc">*</span> (<span class="fu">mean</span>(y) <span class="sc">-</span> theta.pos[<span class="dv">1</span>]))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb81-20"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="co">#simulacion de la distribucion posterior condicional de theta</span></span>
<span id="cb81-21"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-21" aria-hidden="true" tabindex="-1"></a>sigma2.pos[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rinvgamma</span>(<span class="dv">1</span>, a.n, b.n)</span>
<span id="cb81-22"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-23"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-23" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb81-24"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Muestreo de Gibbs #</span></span>
<span id="cb81-25"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-25" aria-hidden="true" tabindex="-1"></a><span class="do">#####################</span></span>
<span id="cb81-26"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-27"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nsim){</span>
<span id="cb81-28"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#parametros posteriores de theta  </span></span>
<span id="cb81-29"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-29" aria-hidden="true" tabindex="-1"></a>  tau2.n <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> ((n<span class="sc">/</span>sigma2.pos[i <span class="sc">-</span> <span class="dv">1</span>]) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span>tau2))</span>
<span id="cb81-30"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-30" aria-hidden="true" tabindex="-1"></a>  mu.n <span class="ot">&lt;-</span> tau2.n <span class="sc">*</span> (<span class="fu">mean</span>(y) <span class="sc">*</span> (n<span class="sc">/</span>sigma2.pos[i <span class="sc">-</span> <span class="dv">1</span>]) <span class="sc">+</span> mu<span class="sc">/</span>tau2)</span>
<span id="cb81-31"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#simulacion de la distribucion posterior condicional de theta</span></span>
<span id="cb81-32"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-32" aria-hidden="true" tabindex="-1"></a>  theta.pos[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean=</span>mu.n, <span class="at">sd=</span><span class="fu">sqrt</span>(tau2.n))</span>
<span id="cb81-33"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#parametros posteriores de sigma2 </span></span>
<span id="cb81-34"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-34" aria-hidden="true" tabindex="-1"></a>  a.n <span class="ot">&lt;-</span> a <span class="sc">+</span> n<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb81-35"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-35" aria-hidden="true" tabindex="-1"></a>  b.n <span class="ot">&lt;-</span> b <span class="sc">+</span> ((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">var</span>(y) <span class="sc">+</span> n <span class="sc">*</span> (<span class="fu">mean</span>(y) <span class="sc">-</span> theta.pos[i])) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb81-36"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#simulacion de la distribucion posterior condicional de theta</span></span>
<span id="cb81-37"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-37" aria-hidden="true" tabindex="-1"></a>  sigma2.pos[i] <span class="ot">&lt;-</span> <span class="fu">rinvgamma</span>(<span class="dv">1</span>, a.n, b.n)</span>
<span id="cb81-38"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb81-38" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(theta.pos)</span></code></pre></div>
<pre><code>## [1] 0.08134119</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(theta.pos, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## -0.7351317  0.8825539</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">sqrt</span>(sigma2.pos))</span></code></pre></div>
<pre><code>## [1] 1.54241</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(<span class="fu">sqrt</span>(sigma2.pos), <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##     2.5%    97.5% 
## 1.020166 2.347198</code></pre>
<p>De donde podemos concluir que los resultados de este algoritmo de Gibbs coinciden con la estimación puntual para la esperanza de <span class="math inline">\(Y\)</span>, su desviación estándar, y sus intervalos de credibilidad del 95%, obtenidos con <code>STAN</code>.</p>
<div class="figure" style="text-align: center"><span id="fig:plotsNormalMV"></span>
<img src="4Multiparametricos_files/figure-html/plotsNormalMV-1.svg" alt="Convergencia de las distribuciones posteriores y diagramas de la función de autocorrelación en las cadenas." width="768" />
<p class="caption">
Figura 4.2: Convergencia de las distribuciones posteriores y diagramas de la función de autocorrelación en las cadenas.
</p>
</div>
<p>Las figuras <a href="modelo-normal-con-media-y-varianza-desconocida.html#fig:plotsNormalMV">4.2</a> muestran que la convergencia de las cadenas es inmediata y que además no existen correlaciones importantes en los valores simulados de <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\sigma^2\)</span>. Por tanto, se concluye que se pueden utilizar directamente estos valores para la obtención de las estimaciones. Finalmente se ilustra la forma de obtener la distribución predictiva para el promedio muestral de 5 nuevos pacientes.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb90-1" aria-hidden="true" tabindex="-1"></a>n.ast <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb90-2"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb90-2" aria-hidden="true" tabindex="-1"></a>y.bar <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb90-3"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(nsim<span class="sc">/</span><span class="dv">2</span>)){</span>
<span id="cb90-5"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb90-5" aria-hidden="true" tabindex="-1"></a>  y.bar[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,</span>
<span id="cb90-6"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb90-6" aria-hidden="true" tabindex="-1"></a>                    theta.pos[i <span class="sc">+</span> nsim<span class="sc">/</span><span class="dv">2</span>],</span>
<span id="cb90-7"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb90-7" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">sqrt</span>(sigma2.pos[i <span class="sc">+</span> nsim<span class="sc">/</span><span class="dv">2</span>]<span class="sc">/</span>n.ast))</span>
<span id="cb90-8"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb90-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-9"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y.bar)</span></code></pre></div>
<pre><code>## [1] 0.1030324</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(y.bar)</span></code></pre></div>
<pre><code>## [1] 0.7967851</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="modelo-normal-con-media-y-varianza-desconocida.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(y.bar,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## -1.514231  1.553076</code></pre>
<p>Podemos ver que se espera que el promedio de las pruebas en 5 nuevos pacientes es de 0.1030324, con un intervalo de credibilidad del 95% que es mucho más ancho que el de <span class="math inline">\(\theta\)</span>, pues naturalmente <span class="math inline">\(\bar{Y}\)</span> tiene mayor incertidumbre que los parámetros del modelo; además, el tamaño de nuevos datos es de cinco, el cual es pequeño y hace que el pronóstico para <span class="math inline">\(\bar{Y}^*\)</span> no sea muy preciso.</p>

</div>
</div>
<!-- </div> -->



<h3>Referencias</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Efronims" class="csl-entry">
Efron, B. 2010. <em><span>Large-Scale Inference. Empirical Bayes Methods for Estimation, Testing, and Prediction</span></em>. Cambridge University Press.
</div>
<div id="ref-MCMCpack" class="csl-entry">
Martin, Andrew D., Kevin M. Quinn, y Jong Hee Park. 2011. <span>«<span>MCMCpack</span>: Markov Chain Monte Carlo in <span>R</span>»</span>. <em>Journal of Statistical Software</em> 42 (9): 22. <a href="http://www.jstatsoft.org/v42/i09/">http://www.jstatsoft.org/v42/i09/</a>.
</div>
<div id="ref-Migon" class="csl-entry">
Migon, H. S., y D. Gamerman. 1999. <em>Statistical Inference: An Integrated Approach</em>. Arnold.
</div>
<div id="ref-Zhang" class="csl-entry">
Zhang, H., y H. A. Gutiérrez. 2010. <em>Teoría estadística. Aplicación y métodos.</em> Universidad Santo Tomás.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-multiparamétricos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="elementos-de-probabilidad.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/bookdownBayesiano/4Multiparametricos.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ModelosBayesianos.pdf", "ModelosBayesianos.epub", "ModelosBayesianos.mobi"],
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
