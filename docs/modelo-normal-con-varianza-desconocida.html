<!DOCTYPE html>
<html lang="es" xml:lang="es">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.7 Modelo Normal con varianza desconocida | Modelos Bayesianos con R y STAN</title>
  <meta name="description" content="Este es el repositorio del libro Modelos Bayesianos con R y STAN." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="3.7 Modelo Normal con varianza desconocida | Modelos Bayesianos con R y STAN" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este es el repositorio del libro Modelos Bayesianos con R y STAN." />
  <meta name="github-repo" content="psirusteam/bookdownBayesiano" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.7 Modelo Normal con varianza desconocida | Modelos Bayesianos con R y STAN" />
  
  <meta name="twitter:description" content="Este es el repositorio del libro Modelos Bayesianos con R y STAN." />
  

<meta name="author" content="Andrés Gutiérrez - Hanwen Zhang" />


<meta name="date" content="2021-07-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="modelo-normal-con-media-desconocida.html"/>
<link rel="next" href="modelos-multiparamétricos.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos Bayesianos con R y STAN</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a></li>
<li class="chapter" data-level="" data-path="antes-de-comenzar.html"><a href="antes-de-comenzar.html"><i class="fa fa-check"></i>Antes de comenzar</a>
<ul>
<li class="chapter" data-level="" data-path="cuestionamientos-sobre-el-enfoque-bayesiano.html"><a href="cuestionamientos-sobre-el-enfoque-bayesiano.html"><i class="fa fa-check"></i>Cuestionamientos sobre el enfoque bayesiano</a></li>
<li class="chapter" data-level="" data-path="acerca-de-la-notación.html"><a href="acerca-de-la-notación.html"><i class="fa fa-check"></i>Acerca de la notación</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="tópicos-básicos.html"><a href="tópicos-básicos.html"><i class="fa fa-check"></i><b>1</b> Tópicos básicos</a>
<ul>
<li class="chapter" data-level="1.1" data-path="teoría-de-la-decisión.html"><a href="teoría-de-la-decisión.html"><i class="fa fa-check"></i><b>1.1</b> Teoría de la decisión</a></li>
<li class="chapter" data-level="1.2" data-path="algunos-resultados-de-probabilidad.html"><a href="algunos-resultados-de-probabilidad.html"><i class="fa fa-check"></i><b>1.2</b> Algunos resultados de probabilidad</a></li>
<li class="chapter" data-level="1.3" data-path="teorema-de-bayes.html"><a href="teorema-de-bayes.html"><i class="fa fa-check"></i><b>1.3</b> Teorema de Bayes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="inferencia-bayesiana.html"><a href="inferencia-bayesiana.html"><i class="fa fa-check"></i><b>2</b> Inferencia bayesiana</a>
<ul>
<li class="chapter" data-level="2.1" data-path="la-distribución-previa.html"><a href="la-distribución-previa.html"><i class="fa fa-check"></i><b>2.1</b> La distribución previa</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="la-distribución-previa.html"><a href="la-distribución-previa.html#distribuciones-conjugadas"><i class="fa fa-check"></i><b>2.1.1</b> Distribuciones conjugadas</a></li>
<li class="chapter" data-level="2.1.2" data-path="la-distribución-previa.html"><a href="la-distribución-previa.html#familia-exponencial"><i class="fa fa-check"></i><b>2.1.2</b> Familia exponencial</a></li>
<li class="chapter" data-level="2.1.3" data-path="la-distribución-previa.html"><a href="la-distribución-previa.html#distribuciones-previas-no-informativas"><i class="fa fa-check"></i><b>2.1.3</b> Distribuciones previas no informativas</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html"><i class="fa fa-check"></i><b>2.2</b> Pruebas de hipótesis</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#factor-de-bayes"><i class="fa fa-check"></i><b>2.2.1</b> Factor de Bayes</a></li>
<li class="chapter" data-level="2.2.2" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#valor-p-bayesiano"><i class="fa fa-check"></i><b>2.2.2</b> Valor-<span class="math inline">\(p\)</span> Bayesiano</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="criterios-de-información.html"><a href="criterios-de-información.html"><i class="fa fa-check"></i><b>2.3</b> Criterios de información</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="criterios-de-información.html"><a href="criterios-de-información.html#criterio-dic"><i class="fa fa-check"></i><b>2.3.1</b> Criterio DIC</a></li>
<li class="chapter" data-level="2.3.2" data-path="criterios-de-información.html"><a href="criterios-de-información.html#criterios-aic-y-bic"><i class="fa fa-check"></i><b>2.3.2</b> Criterios AIC y BIC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelos-uniparamétricos.html"><a href="modelos-uniparamétricos.html"><i class="fa fa-check"></i><b>3</b> Modelos uniparamétricos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modelo-bernoulli.html"><a href="modelo-bernoulli.html"><i class="fa fa-check"></i><b>3.1</b> Modelo Bernoulli</a></li>
<li class="chapter" data-level="3.2" data-path="modelo-binomial.html"><a href="modelo-binomial.html"><i class="fa fa-check"></i><b>3.2</b> Modelo Binomial</a></li>
<li class="chapter" data-level="3.3" data-path="modelo-binomial-negativo.html"><a href="modelo-binomial-negativo.html"><i class="fa fa-check"></i><b>3.3</b> Modelo Binomial negativo</a></li>
<li class="chapter" data-level="3.4" data-path="modelo-poisson.html"><a href="modelo-poisson.html"><i class="fa fa-check"></i><b>3.4</b> Modelo Poisson</a></li>
<li class="chapter" data-level="3.5" data-path="modelo-exponencial.html"><a href="modelo-exponencial.html"><i class="fa fa-check"></i><b>3.5</b> Modelo Exponencial</a></li>
<li class="chapter" data-level="3.6" data-path="modelo-normal-con-media-desconocida.html"><a href="modelo-normal-con-media-desconocida.html"><i class="fa fa-check"></i><b>3.6</b> Modelo Normal con media desconocida</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="modelo-normal-con-media-desconocida.html"><a href="modelo-normal-con-media-desconocida.html#distribución-previa-no-informativa-para-theta"><i class="fa fa-check"></i><b>3.6.1</b> Distribución previa no informativa para <span class="math inline">\(\theta\)</span></a></li>
<li class="chapter" data-level="3.6.2" data-path="modelo-normal-con-media-desconocida.html"><a href="modelo-normal-con-media-desconocida.html#diferentes-formas-de-hallar-la-distribución-previa-para-theta"><i class="fa fa-check"></i><b>3.6.2</b> Diferentes formas de hallar la distribución previa para <span class="math inline">\(\theta\)</span></a></li>
<li class="chapter" data-level="3.6.3" data-path="modelo-normal-con-media-desconocida.html"><a href="modelo-normal-con-media-desconocida.html#distribuciones-predictivas"><i class="fa fa-check"></i><b>3.6.3</b> Distribuciones predictivas</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="modelo-normal-con-varianza-desconocida.html"><a href="modelo-normal-con-varianza-desconocida.html"><i class="fa fa-check"></i><b>3.7</b> Modelo Normal con varianza desconocida</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelos-multiparamétricos.html"><a href="modelos-multiparamétricos.html"><i class="fa fa-check"></i><b>4</b> Modelos multiparamétricos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelo-normal-con-media-y-varianza-desconocida.html"><a href="modelo-normal-con-media-y-varianza-desconocida.html"><i class="fa fa-check"></i><b>4.1</b> Modelo Normal con media y varianza desconocida</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="modelo-normal-con-media-y-varianza-desconocida.html"><a href="modelo-normal-con-media-y-varianza-desconocida.html#parámetros-independientes"><i class="fa fa-check"></i><b>4.1.1</b> Parámetros independientes</a></li>
<li class="chapter" data-level="4.1.2" data-path="modelo-normal-con-media-y-varianza-desconocida.html"><a href="modelo-normal-con-media-y-varianza-desconocida.html#parámetros-dependientes"><i class="fa fa-check"></i><b>4.1.2</b> Parámetros dependientes</a></li>
<li class="chapter" data-level="4.1.3" data-path="modelo-normal-con-media-y-varianza-desconocida.html"><a href="modelo-normal-con-media-y-varianza-desconocida.html#parámetros-no-informativos"><i class="fa fa-check"></i><b>4.1.3</b> Parámetros no informativos</a></li>
<li class="chapter" data-level="4.1.4" data-path="modelo-normal-con-media-y-varianza-desconocida.html"><a href="modelo-normal-con-media-y-varianza-desconocida.html#distribución-predictiva"><i class="fa fa-check"></i><b>4.1.4</b> Distribución predictiva</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="modelo-normal-multivariante-con-media-desconocida-y-varianza-conocida.html"><a href="modelo-normal-multivariante-con-media-desconocida-y-varianza-conocida.html"><i class="fa fa-check"></i><b>4.2</b> Modelo Normal multivariante con media desconocida y varianza conocida</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="modelo-normal-multivariante-con-media-desconocida-y-varianza-conocida.html"><a href="modelo-normal-multivariante-con-media-desconocida-y-varianza-conocida.html#distribución-previa-no-informativa"><i class="fa fa-check"></i><b>4.2.1</b> Distribución previa no informativa</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modelo-normal-multivariante-con-media-y-varianza-desconocida.html"><a href="modelo-normal-multivariante-con-media-y-varianza-desconocida.html"><i class="fa fa-check"></i><b>4.3</b> Modelo Normal multivariante con media y varianza desconocida</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="modelo-normal-multivariante-con-media-y-varianza-desconocida.html"><a href="modelo-normal-multivariante-con-media-y-varianza-desconocida.html#parámetros-independientes-con-distribuciones-previas-informativas"><i class="fa fa-check"></i><b>4.3.1</b> Parámetros independientes con distribuciones previas informativas</a></li>
<li class="chapter" data-level="4.3.2" data-path="modelo-normal-multivariante-con-media-y-varianza-desconocida.html"><a href="modelo-normal-multivariante-con-media-y-varianza-desconocida.html#parámetros-dependientes-1"><i class="fa fa-check"></i><b>4.3.2</b> Parámetros dependientes</a></li>
<li class="chapter" data-level="4.3.3" data-path="modelo-normal-multivariante-con-media-y-varianza-desconocida.html"><a href="modelo-normal-multivariante-con-media-y-varianza-desconocida.html#parámetros-no-informativos-1"><i class="fa fa-check"></i><b>4.3.3</b> Parámetros no informativos</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="modelo-multinomial.html"><a href="modelo-multinomial.html"><i class="fa fa-check"></i><b>4.4</b> Modelo Multinomial</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelos-empíricos-y-jerárquicos.html"><a href="modelos-empíricos-y-jerárquicos.html"><i class="fa fa-check"></i><b>5</b> Modelos empíricos y jerárquicos</a>
<ul>
<li class="chapter" data-level="5.1" data-path="análisis-empírico.html"><a href="análisis-empírico.html"><i class="fa fa-check"></i><b>5.1</b> Análisis empírico</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="análisis-empírico.html"><a href="análisis-empírico.html#modelo-binomial-beta"><i class="fa fa-check"></i><b>5.1.1</b> Modelo Binomial-Beta</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Apéndice</b></span></li>
<li class="chapter" data-level="A" data-path="elementos-de-probabilidad.html"><a href="elementos-de-probabilidad.html"><i class="fa fa-check"></i><b>A</b> Elementos de probabilidad</a>
<ul>
<li class="chapter" data-level="A.1" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html"><i class="fa fa-check"></i><b>A.1</b> Distribuciones discretas</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-uniforme-discreta"><i class="fa fa-check"></i><b>A.1.1</b> Distribución uniforme discreta</a></li>
<li class="chapter" data-level="A.1.2" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-hipergeométrica"><i class="fa fa-check"></i><b>A.1.2</b> Distribución hipergeométrica</a></li>
<li class="chapter" data-level="A.1.3" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-bernoulli"><i class="fa fa-check"></i><b>A.1.3</b> Distribución Bernoulli</a></li>
<li class="chapter" data-level="A.1.4" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-binomial"><i class="fa fa-check"></i><b>A.1.4</b> Distribución binomial</a></li>
<li class="chapter" data-level="A.1.5" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-binomial-negativa"><i class="fa fa-check"></i><b>A.1.5</b> Distribución Binomial negativa</a></li>
<li class="chapter" data-level="A.1.6" data-path="distribuciones-discretas.html"><a href="distribuciones-discretas.html#distribución-de-poisson"><i class="fa fa-check"></i><b>A.1.6</b> Distribución de Poisson</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html"><i class="fa fa-check"></i><b>A.2</b> Distribuciones continuas</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-uniforme-continua"><i class="fa fa-check"></i><b>A.2.1</b> Distribución Uniforme Continua</a></li>
<li class="chapter" data-level="A.2.2" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-weibull"><i class="fa fa-check"></i><b>A.2.2</b> Distribución Weibull</a></li>
<li class="chapter" data-level="A.2.3" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-valor-extremo"><i class="fa fa-check"></i><b>A.2.3</b> Distribución valor-extremo</a></li>
<li class="chapter" data-level="A.2.4" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-gamma"><i class="fa fa-check"></i><b>A.2.4</b> Distribución Gamma</a></li>
<li class="chapter" data-level="A.2.5" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-gamma-inversa"><i class="fa fa-check"></i><b>A.2.5</b> Distribución Gamma-inversa</a></li>
<li class="chapter" data-level="A.2.6" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-exponencial"><i class="fa fa-check"></i><b>A.2.6</b> Distribución exponencial</a></li>
<li class="chapter" data-level="A.2.7" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-beta"><i class="fa fa-check"></i><b>A.2.7</b> Distribución Beta</a></li>
<li class="chapter" data-level="A.2.8" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-normal"><i class="fa fa-check"></i><b>A.2.8</b> Distribución normal</a></li>
<li class="chapter" data-level="A.2.9" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-log-normal"><i class="fa fa-check"></i><b>A.2.9</b> Distribución log-normal</a></li>
<li class="chapter" data-level="A.2.10" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-ji-cuadrado"><i class="fa fa-check"></i><b>A.2.10</b> Distribución Ji-cuadrado</a></li>
<li class="chapter" data-level="A.2.11" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-t-student"><i class="fa fa-check"></i><b>A.2.11</b> Distribución t-student</a></li>
<li class="chapter" data-level="A.2.12" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-t-student-generalizada"><i class="fa fa-check"></i><b>A.2.12</b> Distribución t-student generalizada</a></li>
<li class="chapter" data-level="A.2.13" data-path="distribuciones-continuas.html"><a href="distribuciones-continuas.html#distribución-f"><i class="fa fa-check"></i><b>A.2.13</b> Distribución F</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html"><i class="fa fa-check"></i><b>A.3</b> Distribuciones multivariadas</a>
<ul>
<li class="chapter" data-level="A.3.1" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#distribución-multinomial"><i class="fa fa-check"></i><b>A.3.1</b> Distribución Multinomial</a></li>
<li class="chapter" data-level="A.3.2" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#distribución-dirichelt"><i class="fa fa-check"></i><b>A.3.2</b> Distribución Dirichelt</a></li>
<li class="chapter" data-level="A.3.3" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#distribución-normal-multivariante"><i class="fa fa-check"></i><b>A.3.3</b> Distribución Normal Multivariante</a></li>
<li class="chapter" data-level="A.3.4" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#distribución-wishart"><i class="fa fa-check"></i><b>A.3.4</b> Distribución Wishart</a></li>
<li class="chapter" data-level="A.3.5" data-path="distribuciones-multivariadas.html"><a href="distribuciones-multivariadas.html#distribución-inversa-wishart"><i class="fa fa-check"></i><b>A.3.5</b> Distribución inversa-Wishart</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="matriz-de-información.html"><a href="matriz-de-información.html"><i class="fa fa-check"></i><b>B</b> Matriz de información</a></li>
<li class="chapter" data-level="C" data-path="elementos-de-simulación-estadística.html"><a href="elementos-de-simulación-estadística.html"><i class="fa fa-check"></i><b>C</b> Elementos de simulación estadística</a>
<ul>
<li class="chapter" data-level="C.1" data-path="métodos-directos.html"><a href="métodos-directos.html"><i class="fa fa-check"></i><b>C.1</b> Métodos directos</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="métodos-directos.html"><a href="métodos-directos.html#método-de-la-transformación-uniforme"><i class="fa fa-check"></i><b>C.1.1</b> Método de la transformación uniforme</a></li>
<li class="chapter" data-level="C.1.2" data-path="métodos-directos.html"><a href="métodos-directos.html#método-de-la-grilla"><i class="fa fa-check"></i><b>C.1.2</b> Método de la grilla</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="métodos-de-monte-carlo-vía-cadenas-de-markov.html"><a href="métodos-de-monte-carlo-vía-cadenas-de-markov.html"><i class="fa fa-check"></i><b>C.2</b> Métodos de Monte Carlo vía cadenas de Markov</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="métodos-de-monte-carlo-vía-cadenas-de-markov.html"><a href="métodos-de-monte-carlo-vía-cadenas-de-markov.html#el-muestreador-de-gibbs"><i class="fa fa-check"></i><b>C.2.1</b> El muestreador de Gibbs</a></li>
<li class="chapter" data-level="C.2.2" data-path="métodos-de-monte-carlo-vía-cadenas-de-markov.html"><a href="métodos-de-monte-carlo-vía-cadenas-de-markov.html#el-algoritmo-de-metrópolis-hastings"><i class="fa fa-check"></i><b>C.2.2</b> El algoritmo de Metrópolis-Hastings</a></li>
<li class="chapter" data-level="C.2.3" data-path="métodos-de-monte-carlo-vía-cadenas-de-markov.html"><a href="métodos-de-monte-carlo-vía-cadenas-de-markov.html#buenas-prácticas-en-la-aplicación-de-métodos-mcmc"><i class="fa fa-check"></i><b>C.2.3</b> Buenas prácticas en la aplicación de métodos MCMC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a Modelos Bayesianos con R y STAN</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos Bayesianos con R y STAN</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelo-normal-con-varianza-desconocida" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Modelo Normal con varianza desconocida</h2>
<p>En esta sección se presentan los fundamentos necesario para realizar inferencia bayesiana en un modelo normal para el cual sí se conoce la media, pero no su varianza. En casi todas las aplicaciones prácticas, es común que ambos parámetros sean desconocidos. Sin embargo, estas secciones servirán de base teórica para desarrollar modelos más complejos. Supóngase además que se cuenta con información previa, la cual puede basarse sin pérdida de generalidad en observaciones anteriores de alguna muestra de tamaño <span class="math inline">\(n_0\)</span> cuya varianza estimada fue <span class="math inline">\(\sigma^2_0\)</span>.</p>
<p>En este orden de ideas, y siguiendo la argumentación de las secciones anteriores, dado que la varianza de la distribución es un parámetro que toma valores positivos únicamente, es plausible plantear que su distribución previa sea
<span class="math display">\[\begin{equation*}
\sigma^2 \sim Inversa-Gamma(n_0/2, n_0\sigma^2_0/2)
\end{equation*}\]</span></p>
<p>Siguiendo la regla de Bayes, y después de factorizar convenientemente, se encuentra el siguiente resultado que muestra que la distribución posterior es conjugada con respecto a la previa.</p>

<div class="proposition">
<span id="prp:unnamed-chunk-77" class="proposition"><strong>Resultado 3.19  </strong></span>La distribución posterior condicional de <span class="math inline">\(\sigma^2\)</span> es
<span class="math display">\[\begin{equation}
\sigma^2  \mid  \theta, \mathbf{Y} \sim Inversa-Gamma\left(\dfrac{n_0+n}{2},\dfrac{v_0}{2}\right)
\end{equation}\]</span>
con <span class="math inline">\(v_0=n_0\sigma^2_0+(n-1)S^2+n(\bar{y}-\theta)^2\)</span>.
</div>
<p>A continuación se presenta un ejemplo de modelación de la varianza en una distribución normal. Como se vió en los anteriores resultados, la distribución previa conjugada toma la forma de una Gamma-inversa, sin embargo el investigador debe sopesar las ventajas de considerar esta distribución, puesto que las características del modelo bayesiano no sólo recaen en la definición de la verosimilitud, sino también en la estructura de la distribución previa. Es decir, en algunas ocasiones es mejor ponderar las bondades predictivas y de ajuste de los modelos, antes que escoger una distribución conjugada. Por ejemplo, <span class="citation"><a href="#ref-GelmanVariance2006" role="doc-biblioref">Andrew Gelman</a> (<a href="#ref-GelmanVariance2006" role="doc-biblioref">2006</a>)</span> presentan diferentes opciones de distribuciones previas para modelar la varianza; sin embargo, el desarrollo teórico de estas otras posibles escogencias necesitan de herramientas metodológicas que se considerarán en los posteriores capítulos.</p>

<div class="example">
<p><span id="exm:8escuelas" class="example"><strong>Ejemplo 3.12  </strong></span><span class="citation"><a href="#ref-Gelman95" role="doc-biblioref">A. Gelman et al.</a> (<a href="#ref-Gelman95" role="doc-biblioref">1995</a> , sección 5.5.)</span> presentan un estudio realizado para analizar los efectos de algunos programas de entrenamiento especial en preparación para una prueba estandariza de opción múltiple llamada <em>SAT</em>, la cual es utilizada por las universidades para tomar decisiones con respecto a la adminsión de sus estudiantes. Quienes presenten mejores puntuaciones tienen una mayor probabilidad de ser admitidos para cursas sus estudios de educación superior.</p>
<p>Las puntuaciones del <em>SAT</em> pueden variar entre 200 y 800, con una media de 500 y una desviación estándar de 100. Los exámenes SAT están diseñados para reflejar los conocimientos adquiridos y las habilidades desarrolladas durante muchos años de educación. Sin embargo, cada una de las ocho escuelas en este estudio consideró que su programa de entrenamiento a corto plazo fue muy exitoso para aumentar los puntajes de la prueba. Además, no había ninguna razón previa para creer que alguno de los ocho programas fuera más efectivo que cualquier otro o que algunos fueran más similares en efecto entre sí que cualquier otro.</p>
La variable de interés en este ejemplo es el efecto del programa de entrenamiento en ocho escuelas secuendarias. Este efecto se define como la diferencia entre el puntaje promedio de la escuela con el promedio de la escala de la prueba (500 puntos). Además, en una administración especial de la prueba para en ocho escuelas secundarias. La figura <a href="modelo-normal-con-varianza-desconocida.html#fig:hist8escuelas">3.20</a> muestra la distribución de los datos observados.
</div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="modelo-normal-con-varianza-desconocida.html#cb65-1" aria-hidden="true" tabindex="-1"></a>Escuelas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb65-2"><a href="modelo-normal-con-varianza-desconocida.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;H&quot;</span>),</span>
<span id="cb65-3"><a href="modelo-normal-con-varianza-desconocida.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">efecto =</span> <span class="fu">c</span>(<span class="fl">28.39</span>, <span class="fl">7.94</span>, <span class="sc">-</span><span class="fl">2.75</span>, <span class="fl">6.82</span>,</span>
<span id="cb65-4"><a href="modelo-normal-con-varianza-desconocida.html#cb65-4" aria-hidden="true" tabindex="-1"></a>             <span class="sc">-</span><span class="fl">0.64</span>, <span class="fl">0.63</span>, <span class="fl">18.01</span>, <span class="fl">12.16</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:hist8escuelas"></span>
<img src="3Uniparametricos_files/figure-html/hist8escuelas-1.svg" alt="Histograma de los efectos en las ocho escuelas." width="576" />
<p class="caption">
Figura 3.20: Histograma de los efectos en las ocho escuelas.
</p>
</div>
<p>En el siguiente apartado se hará uso de <code>STAN</code> para realizar la inferencia bayesiana del parámetro de interés. Aunque, como ya se vio en las secciones anteriores, es posible utilizar simplemente <code>R</code>, acudiendo a los percentiles de la distribución posterior. Para este ejemplo, no se asume un conocimiento específico del fenómeno en la distribución previa. Por consiguiente se definirán parámetros no informativos sobre la distribución previa.</p>
<p>Notando la forma funcional de la distribución Gamma-inversa, al hacer que sus parámetros tomen valores muy pequeños <span class="math inline">\((\alpha \rightarrow \infty, \ \ \beta \rightarrow \infty)\)</span> se tiene que</p>
<p><span class="math display">\[\begin{align*}
p(\sigma^2|\alpha,\beta) 
&amp;\propto (\sigma^2)^{-\alpha-1}
\exp(-\frac{\beta}{\sigma^2}) \\
&amp;\propto \frac{1}{\sigma^2}
\end{align*}\]</span></p>
<p>La cual coincide con la distribución previa de Jeffreys. De esta forma, para que la distribución previa sea propia (integral definida de la función de densidad), se escogen valores cercanos a cero, pero no nulos; por ejemplo <span class="math inline">\(\alpha = 0.001, \ \ \beta = 0.001\)</span>. La figura <a href="modelo-normal-con-varianza-desconocida.html#fig:jefgammainv">3.21</a> muestra la densidad previa no informativa para el parámetro de interés.</p>
<div class="figure" style="text-align: center"><span id="fig:jefgammainv"></span>
<img src="3Uniparametricos_files/figure-html/jefgammainv-1.svg" alt="Distribución previa no informativa para la varianza de una distribución Normal" width="576" />
<p class="caption">
Figura 3.21: Distribución previa no informativa para la varianza de una distribución Normal
</p>
</div>
<p>Es posible notar que esta distribución provee un intervalo de confianza del 95% entre 176079526 e infinito. Por lo que se puede concluir que hay una muy baja probabilidad de que el parámetro tome valores muy bajos o muy altos. Por ejemplo, <span class="math inline">\(Pr(\sigma^2 &lt; 10) = 0.00859688\)</span>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="modelo-normal-con-varianza-desconocida.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl)</span>
<span id="cb66-2"><a href="modelo-normal-con-varianza-desconocida.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), </span>
<span id="cb66-3"><a href="modelo-normal-con-varianza-desconocida.html#cb66-3" aria-hidden="true" tabindex="-1"></a>       <span class="cf">function</span>(x) <span class="fu">qigamma</span>(x, <span class="fl">0.001</span>, <span class="fl">0.001</span>))</span></code></pre></div>
<pre><code>## [1] 176079526       Inf</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="modelo-normal-con-varianza-desconocida.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pigamma</span>(<span class="dv">10</span>, <span class="fl">0.001</span>, <span class="fl">0.001</span>)</span></code></pre></div>
<pre><code>## [1] 0.00859688</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="modelo-normal-con-varianza-desconocida.html#cb70-1" aria-hidden="true" tabindex="-1"></a>NormalVar <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb70-2"><a href="modelo-normal-con-varianza-desconocida.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb70-3"><a href="modelo-normal-con-varianza-desconocida.html#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower=0&gt; n;</span></span>
<span id="cb70-4"><a href="modelo-normal-con-varianza-desconocida.html#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="st">  real mu;</span></span>
<span id="cb70-5"><a href="modelo-normal-con-varianza-desconocida.html#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="st">  real y[n];</span></span>
<span id="cb70-6"><a href="modelo-normal-con-varianza-desconocida.html#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb70-7"><a href="modelo-normal-con-varianza-desconocida.html#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb70-8"><a href="modelo-normal-con-varianza-desconocida.html#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="st">  real sigma;</span></span>
<span id="cb70-9"><a href="modelo-normal-con-varianza-desconocida.html#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb70-10"><a href="modelo-normal-con-varianza-desconocida.html#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb70-11"><a href="modelo-normal-con-varianza-desconocida.html#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="st">  real sigma2;</span></span>
<span id="cb70-12"><a href="modelo-normal-con-varianza-desconocida.html#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma2 = pow(sigma, 2);</span></span>
<span id="cb70-13"><a href="modelo-normal-con-varianza-desconocida.html#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb70-14"><a href="modelo-normal-con-varianza-desconocida.html#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb70-15"><a href="modelo-normal-con-varianza-desconocida.html#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="st">  y ~ normal(mu, sigma);</span></span>
<span id="cb70-16"><a href="modelo-normal-con-varianza-desconocida.html#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma2 ~ inv_gamma(0.001, 0.001);</span></span>
<span id="cb70-17"><a href="modelo-normal-con-varianza-desconocida.html#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb70-18"><a href="modelo-normal-con-varianza-desconocida.html#cb70-18" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb70-19"><a href="modelo-normal-con-varianza-desconocida.html#cb70-19" aria-hidden="true" tabindex="-1"></a><span class="st">  real y_test[n];</span></span>
<span id="cb70-20"><a href="modelo-normal-con-varianza-desconocida.html#cb70-20" aria-hidden="true" tabindex="-1"></a><span class="st">  for(i in 1:n) {</span></span>
<span id="cb70-21"><a href="modelo-normal-con-varianza-desconocida.html#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="st">    y_test[i] = normal_rng(mu, sigma);</span></span>
<span id="cb70-22"><a href="modelo-normal-con-varianza-desconocida.html#cb70-22" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb70-23"><a href="modelo-normal-con-varianza-desconocida.html#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb70-24"><a href="modelo-normal-con-varianza-desconocida.html#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb70-25"><a href="modelo-normal-con-varianza-desconocida.html#cb70-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-26"><a href="modelo-normal-con-varianza-desconocida.html#cb70-26" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">y =</span> Escuelas<span class="sc">$</span>efecto, </span>
<span id="cb70-27"><a href="modelo-normal-con-varianza-desconocida.html#cb70-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n =</span> <span class="fu">nrow</span>(Escuelas),</span>
<span id="cb70-28"><a href="modelo-normal-con-varianza-desconocida.html#cb70-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mu =</span> <span class="fu">mean</span>(Escuelas<span class="sc">$</span>efecto))</span>
<span id="cb70-29"><a href="modelo-normal-con-varianza-desconocida.html#cb70-29" aria-hidden="true" tabindex="-1"></a>NormalVfit <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">model_code =</span> NormalVar,</span>
<span id="cb70-30"><a href="modelo-normal-con-varianza-desconocida.html#cb70-30" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> sample_data, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Después de la convergencia del proceso inferencial, la estimación bayesiana de <span class="math inline">\(\sigma^2\)</span> es 10.8, y de <span class="math inline">\(\sigma^2\)</span> es 127.7 cm. De la misma forma, un intervalo de credibilidad del 95% para la desviación estándar es <span class="math inline">\((6.659,\ 19.172)\)</span>.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="modelo-normal-con-varianza-desconocida.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(NormalVfit, <span class="at">digits =</span> <span class="dv">4</span>, </span>
<span id="cb71-2"><a href="modelo-normal-con-varianza-desconocida.html#cb71-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;sigma2&quot;</span>), <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>## Inference for Stan model: db1d737f5b63e0b7dcdc9498c360b64f.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##            mean se_mean      sd    2.5%    97.5% n_eff  Rhat
## sigma   10.9047   0.116  3.1332  6.6574  18.8534   730 1.014
## sigma2 128.7262   3.116 82.6527 44.3207 355.4494   704 1.016
## 
## Samples were drawn using NUTS(diag_e) at Sat Jun 12 11:27:49 2021.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<p>Las figuras <a href="modelo-normal-con-varianza-desconocida.html#fig:posNormalVStan">3.22</a> muestra la distribución posterior para este ejemplo, junto con la estimación puntual, correspondiente a la desviación estándar.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="modelo-normal-con-varianza-desconocida.html#cb73-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_areas</span>(NormalVfit, <span class="at">pars =</span> <span class="st">&quot;sigma&quot;</span>, </span>
<span id="cb73-2"><a href="modelo-normal-con-varianza-desconocida.html#cb73-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prob =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:posNormalVStan"></span>
<img src="3Uniparametricos_files/figure-html/posNormalVStan-1.svg" alt="Distribución posterior." width="576" />
<p class="caption">
Figura 3.22: Distribución posterior.
</p>
</div>
<p>En cualquier caso, es posible sugerir mejores distribuciones no informativas eligiendo apropiadamente un límite superior <span class="math inline">\(U\)</span> y uno inferior <span class="math inline">\(L\)</span> en lugar de parámetros <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span> en la distribución Gamma-inversa. Por lo general, los límites se pueden establecer con bastante facilidad luego de un poco de reflexión sobre lo que <span class="math inline">\(\sigma^2\)</span> realmente significa en el mundo real. Por ejemplo, si fuese el error en algún tipo de cantidad física, <span class="math inline">\(L\)</span> no puede ser más pequeño que el tamaño de un átomo, o el tamaño más pequeño que pueda observar en su experimento. Es más, <span class="math inline">\(U\)</span> no podría ser más grande que la tierra (o el sol si se quisiera ser realmente conservador). De esta manera, una forma de mantener las propiedades de invariancia, es definir <span class="math inline">\(\nu \sim \mathrm{Uniform}(\ln(L),\ln(U))\)</span> para que <span class="math inline">\(\sigma\sim \exp(U(\ln(L),\ln(U))\)</span>. El siguiente código en <code>STAN</code> permite establecer esta opción inferencial.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="modelo-normal-con-varianza-desconocida.html#cb74-1" aria-hidden="true" tabindex="-1"></a>NormalVar2 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb74-2"><a href="modelo-normal-con-varianza-desconocida.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="st">data {</span></span>
<span id="cb74-3"><a href="modelo-normal-con-varianza-desconocida.html#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="st">  int&lt;lower = 0&gt; n;</span></span>
<span id="cb74-4"><a href="modelo-normal-con-varianza-desconocida.html#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="st">  real mu;</span></span>
<span id="cb74-5"><a href="modelo-normal-con-varianza-desconocida.html#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="st">  real y[n];</span></span>
<span id="cb74-6"><a href="modelo-normal-con-varianza-desconocida.html#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb74-7"><a href="modelo-normal-con-varianza-desconocida.html#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="st">parameters {</span></span>
<span id="cb74-8"><a href="modelo-normal-con-varianza-desconocida.html#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="st">  real &lt;lower = 0&gt; nu;</span></span>
<span id="cb74-9"><a href="modelo-normal-con-varianza-desconocida.html#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb74-10"><a href="modelo-normal-con-varianza-desconocida.html#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="st">transformed parameters {</span></span>
<span id="cb74-11"><a href="modelo-normal-con-varianza-desconocida.html#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="st">  real sigma;</span></span>
<span id="cb74-12"><a href="modelo-normal-con-varianza-desconocida.html#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="st">  real sigma2;</span></span>
<span id="cb74-13"><a href="modelo-normal-con-varianza-desconocida.html#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma = exp(nu);</span></span>
<span id="cb74-14"><a href="modelo-normal-con-varianza-desconocida.html#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="st">  sigma2 = pow(sigma, 2);</span></span>
<span id="cb74-15"><a href="modelo-normal-con-varianza-desconocida.html#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb74-16"><a href="modelo-normal-con-varianza-desconocida.html#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="st">model {</span></span>
<span id="cb74-17"><a href="modelo-normal-con-varianza-desconocida.html#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="st">  y ~ normal(mu, sigma);</span></span>
<span id="cb74-18"><a href="modelo-normal-con-varianza-desconocida.html#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="st">  nu ~ uniform(0.5, 20);</span></span>
<span id="cb74-19"><a href="modelo-normal-con-varianza-desconocida.html#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb74-20"><a href="modelo-normal-con-varianza-desconocida.html#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="st">generated quantities {</span></span>
<span id="cb74-21"><a href="modelo-normal-con-varianza-desconocida.html#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="st">  real y_test[n];</span></span>
<span id="cb74-22"><a href="modelo-normal-con-varianza-desconocida.html#cb74-22" aria-hidden="true" tabindex="-1"></a><span class="st">  for(i in 1:n) {</span></span>
<span id="cb74-23"><a href="modelo-normal-con-varianza-desconocida.html#cb74-23" aria-hidden="true" tabindex="-1"></a><span class="st">    y_test[i] = normal_rng(mu, sigma);</span></span>
<span id="cb74-24"><a href="modelo-normal-con-varianza-desconocida.html#cb74-24" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb74-25"><a href="modelo-normal-con-varianza-desconocida.html#cb74-25" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb74-26"><a href="modelo-normal-con-varianza-desconocida.html#cb74-26" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb74-27"><a href="modelo-normal-con-varianza-desconocida.html#cb74-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-28"><a href="modelo-normal-con-varianza-desconocida.html#cb74-28" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">y =</span> Escuelas<span class="sc">$</span>efecto, </span>
<span id="cb74-29"><a href="modelo-normal-con-varianza-desconocida.html#cb74-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">n =</span> <span class="fu">nrow</span>(Escuelas),</span>
<span id="cb74-30"><a href="modelo-normal-con-varianza-desconocida.html#cb74-30" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mu =</span> <span class="fu">mean</span>(Escuelas<span class="sc">$</span>efecto))</span>
<span id="cb74-31"><a href="modelo-normal-con-varianza-desconocida.html#cb74-31" aria-hidden="true" tabindex="-1"></a>NormalVfit2 <span class="ot">&lt;-</span> <span class="fu">stan</span>(<span class="at">model_code =</span> NormalVar2,</span>
<span id="cb74-32"><a href="modelo-normal-con-varianza-desconocida.html#cb74-32" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> sample_data, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Después de la convergencia del proceso inferencial, la estimación bayesiana de <span class="math inline">\(\sigma^2\)</span> es 10.8, y de <span class="math inline">\(\sigma^2\)</span> es 128.2 cm. De la misma forma, un intervalo de credibilidad del 95% para la desviación estándar es <span class="math inline">\((6.596,\ 18.795)\)</span>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="modelo-normal-con-varianza-desconocida.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(NormalVfit2, <span class="at">digits =</span> <span class="dv">4</span>, </span>
<span id="cb75-2"><a href="modelo-normal-con-varianza-desconocida.html#cb75-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;sigma2&quot;</span>), <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>## Inference for Stan model: 9fedbb4c644064e4fdb958182968aebc.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##            mean se_mean       sd    2.5%    97.5% n_eff   Rhat
## sigma   10.9963  0.0896   3.3723  6.6836  18.8918  1417 1.0000
## sigma2 132.2874  2.7314 103.1860 44.6711 356.9005  1427 1.0003
## 
## Samples were drawn using NUTS(diag_e) at Sat Jun 12 11:43:07 2021.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<p>Las figuras <a href="modelo-normal-con-varianza-desconocida.html#fig:posNormalVStan2">3.23</a> muestra la distribución posterior para este ejemplo, junto con la estimación puntual, correspondiente a la desviación estándar.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="modelo-normal-con-varianza-desconocida.html#cb77-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_areas</span>(NormalVfit2, <span class="at">pars =</span> <span class="st">&quot;sigma&quot;</span>, </span>
<span id="cb77-2"><a href="modelo-normal-con-varianza-desconocida.html#cb77-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">prob =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:posNormalVStan2"></span>
<img src="3Uniparametricos_files/figure-html/posNormalVStan2-1.svg" alt="Distribución posterior." width="576" />
<p class="caption">
Figura 3.23: Distribución posterior.
</p>
</div>

</div>
<!-- </div> -->
<h3>Referencias</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Gelman95" class="csl-entry">
Gelman, A., J. B. Carlin, H. S. Stern, y D. B. Rubin. 1995. <em>Bayesian Data Analysis</em>. 1.ª ed. Chapman; Hall/CRC.
</div>
<div id="ref-GelmanVariance2006" class="csl-entry">
Gelman, Andrew. 2006. <span>«Prior distributions for variance parameters in hierarchical models»</span>. <em>Bayesian Analysis</em> 1 (3): 515-33.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelo-normal-con-media-desconocida.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelos-multiparamétricos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psirusteam/bookdownBayesiano/3Uniparametricos.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ModelosBayesianos.pdf", "ModelosBayesianos.epub", "ModelosBayesianos.mobi"],
"toc": {
"collapse": "section"
},
"tconfig": null
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
